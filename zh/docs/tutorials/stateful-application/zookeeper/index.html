<!doctype html><html lang=zh class=no-js><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-36037335-10"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-36037335-10');</script><link rel=alternate hreflang=en href=https://kubernetes.io/docs/tutorials/stateful-application/zookeeper/><link rel=alternate hreflang=ko href=https://kubernetes.io/ko/docs/tutorials/stateful-application/zookeeper/><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.74.3"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel="shortcut icon" type=image/png href=/images/favicon.png><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=manifest href=/manifest.webmanifest><link rel=apple-touch-icon href=/images/kubernetes-192x192.png><title>运行 ZooKeeper， 一个 CP 分布式系统 | Kubernetes</title><meta property="og:title" content="运行 ZooKeeper， 一个 CP 分布式系统"><meta property="og:description" content="本教程展示了在 Kubernetes 上使用 PodDisruptionBudgets 和 PodAntiAffinity 特性运行 Apache Zookeeper。
准备开始 在开始本教程前，你应该熟悉以下 Kubernetes 概念。
 Pods Cluster DNS Headless Services PersistentVolumes PersistentVolume Provisioning ConfigMaps StatefulSets PodDisruptionBudgets PodAntiAffinity kubectl CLI  你需要一个至少包含四个节点的集群，每个节点至少 2 CPUs 和 4 GiB 内存。在本教程中你将会 cordon 和 drain 集群的节点。这意味着集群节点上所有的 Pods 将会被终止并移除。这些节点也会暂时变为不可调度。在本教程中你应该使用一个独占的集群，或者保证你造成的干扰不会影响其它租户。
本教程假设你的集群配置为动态的提供 PersistentVolumes。如果你的集群没有配置成这样，在开始本教程前，你需要手动准备三个 20 GiB 的卷。
教程目标 在学习本教程后，你将熟悉下列内容。
 如何使用 StatefulSet 部署一个 ZooKeeper ensemble。 如何使用 ConfigMaps 一致性配置 ensemble。 如何在 ensemble 中 分布 ZooKeeper 服务的部署。 如何在计划维护中使用 PodDisruptionBudgets 确保服务可用性。  ZooKeeper 基础 Apache ZooKeeper 是一个分布式的开源协调服务，用于分布式系统。ZooKeeper 允许你读取、写入数据和发现数据更新。数据按层次结构组织在文件系统中，并复制到 ensemble（一个 ZooKeeper 服务的集合） 中所有的 ZooKeeper 服务。对数据的所有操作都是原子的和顺序一致的。ZooKeeper 通过 Zab 一致性协议在 ensemble 的所有服务之间复制一个状态机来确保这个特性。"><meta property="og:type" content="article"><meta property="og:url" content="https://kubernetes.io/zh/docs/tutorials/stateful-application/zookeeper/"><meta property="article:modified_time" content="2020-06-01T09:23:39-04:00"><meta property="og:site_name" content="Kubernetes"><meta itemprop=name content="运行 ZooKeeper， 一个 CP 分布式系统"><meta itemprop=description content="本教程展示了在 Kubernetes 上使用 PodDisruptionBudgets 和 PodAntiAffinity 特性运行 Apache Zookeeper。
准备开始 在开始本教程前，你应该熟悉以下 Kubernetes 概念。
 Pods Cluster DNS Headless Services PersistentVolumes PersistentVolume Provisioning ConfigMaps StatefulSets PodDisruptionBudgets PodAntiAffinity kubectl CLI  你需要一个至少包含四个节点的集群，每个节点至少 2 CPUs 和 4 GiB 内存。在本教程中你将会 cordon 和 drain 集群的节点。这意味着集群节点上所有的 Pods 将会被终止并移除。这些节点也会暂时变为不可调度。在本教程中你应该使用一个独占的集群，或者保证你造成的干扰不会影响其它租户。
本教程假设你的集群配置为动态的提供 PersistentVolumes。如果你的集群没有配置成这样，在开始本教程前，你需要手动准备三个 20 GiB 的卷。
教程目标 在学习本教程后，你将熟悉下列内容。
 如何使用 StatefulSet 部署一个 ZooKeeper ensemble。 如何使用 ConfigMaps 一致性配置 ensemble。 如何在 ensemble 中 分布 ZooKeeper 服务的部署。 如何在计划维护中使用 PodDisruptionBudgets 确保服务可用性。  ZooKeeper 基础 Apache ZooKeeper 是一个分布式的开源协调服务，用于分布式系统。ZooKeeper 允许你读取、写入数据和发现数据更新。数据按层次结构组织在文件系统中，并复制到 ensemble（一个 ZooKeeper 服务的集合） 中所有的 ZooKeeper 服务。对数据的所有操作都是原子的和顺序一致的。ZooKeeper 通过 Zab 一致性协议在 ensemble 的所有服务之间复制一个状态机来确保这个特性。"><meta itemprop=dateModified content="2020-06-01T09:23:39-04:00"><meta itemprop=wordCount content="2931"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="运行 ZooKeeper， 一个 CP 分布式系统"><meta name=twitter:description content="本教程展示了在 Kubernetes 上使用 PodDisruptionBudgets 和 PodAntiAffinity 特性运行 Apache Zookeeper。
准备开始 在开始本教程前，你应该熟悉以下 Kubernetes 概念。
 Pods Cluster DNS Headless Services PersistentVolumes PersistentVolume Provisioning ConfigMaps StatefulSets PodDisruptionBudgets PodAntiAffinity kubectl CLI  你需要一个至少包含四个节点的集群，每个节点至少 2 CPUs 和 4 GiB 内存。在本教程中你将会 cordon 和 drain 集群的节点。这意味着集群节点上所有的 Pods 将会被终止并移除。这些节点也会暂时变为不可调度。在本教程中你应该使用一个独占的集群，或者保证你造成的干扰不会影响其它租户。
本教程假设你的集群配置为动态的提供 PersistentVolumes。如果你的集群没有配置成这样，在开始本教程前，你需要手动准备三个 20 GiB 的卷。
教程目标 在学习本教程后，你将熟悉下列内容。
 如何使用 StatefulSet 部署一个 ZooKeeper ensemble。 如何使用 ConfigMaps 一致性配置 ensemble。 如何在 ensemble 中 分布 ZooKeeper 服务的部署。 如何在计划维护中使用 PodDisruptionBudgets 确保服务可用性。  ZooKeeper 基础 Apache ZooKeeper 是一个分布式的开源协调服务，用于分布式系统。ZooKeeper 允许你读取、写入数据和发现数据更新。数据按层次结构组织在文件系统中，并复制到 ensemble（一个 ZooKeeper 服务的集合） 中所有的 ZooKeeper 服务。对数据的所有操作都是原子的和顺序一致的。ZooKeeper 通过 Zab 一致性协议在 ensemble 的所有服务之间复制一个状态机来确保这个特性。"><link rel=preload href=/scss/main.min.29d9d9a40037804116049b9cb05556d3c544759c5ed8a73b36824ddcb7c27564.css as=style><link href=/scss/main.min.29d9d9a40037804116049b9cb05556d3c544759c5ed8a73b36824ddcb7c27564.css rel=stylesheet integrity><script src=/js/jquery-3.3.1.min.js integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin=anonymous></script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","url":"https://kubernetes.io","logo":"https://kubernetes.io/images/favicon.png"}</script><meta name=theme-color content="#326ce5"><link rel=stylesheet href=/css/base_fonts.css><link rel=stylesheet href=/css/jquery-ui.min.css><link rel=stylesheet href=/css/callouts.css><link rel=stylesheet href=/css/custom-jekyll/tags.css><meta name=description content="本教程展示了在 Kubernetes 上使用 PodDisruptionBudgets 和 PodAntiAffinity 特性运行 Apache Zookeeper。
准备开始 在开始本教程前，你应该熟悉以下 Kubernetes 概念。
 Pods Cluster DNS Headless Services PersistentVolumes PersistentVolume Provisioning ConfigMaps StatefulSets PodDisruptionBudgets PodAntiAffinity kubectl CLI  你需要一个至少包含四个节点的集群，每个节点至少 2 CPUs 和 4 GiB 内存。在本教程中你将会 cordon 和 drain 集群的节点。这意味着集群节点上所有的 Pods 将会被终止并移除。这些节点也会暂时变为不可调度。在本教程中你应该使用一个独占的集群，或者保证你造成的干扰不会影响其它租户。
本教程假设你的集群配置为动态的提供 PersistentVolumes。如果你的集群没有配置成这样，在开始本教程前，你需要手动准备三个 20 GiB 的卷。
教程目标 在学习本教程后，你将熟悉下列内容。
 如何使用 StatefulSet 部署一个 ZooKeeper ensemble。 如何使用 ConfigMaps 一致性配置 ensemble。 如何在 ensemble 中 分布 ZooKeeper 服务的部署。 如何在计划维护中使用 PodDisruptionBudgets 确保服务可用性。  ZooKeeper 基础 Apache ZooKeeper 是一个分布式的开源协调服务，用于分布式系统。ZooKeeper 允许你读取、写入数据和发现数据更新。数据按层次结构组织在文件系统中，并复制到 ensemble（一个 ZooKeeper 服务的集合） 中所有的 ZooKeeper 服务。对数据的所有操作都是原子的和顺序一致的。ZooKeeper 通过 Zab 一致性协议在 ensemble 的所有服务之间复制一个状态机来确保这个特性。"><meta property="og:description" content="本教程展示了在 Kubernetes 上使用 PodDisruptionBudgets 和 PodAntiAffinity 特性运行 Apache Zookeeper。
准备开始 在开始本教程前，你应该熟悉以下 Kubernetes 概念。
 Pods Cluster DNS Headless Services PersistentVolumes PersistentVolume Provisioning ConfigMaps StatefulSets PodDisruptionBudgets PodAntiAffinity kubectl CLI  你需要一个至少包含四个节点的集群，每个节点至少 2 CPUs 和 4 GiB 内存。在本教程中你将会 cordon 和 drain 集群的节点。这意味着集群节点上所有的 Pods 将会被终止并移除。这些节点也会暂时变为不可调度。在本教程中你应该使用一个独占的集群，或者保证你造成的干扰不会影响其它租户。
本教程假设你的集群配置为动态的提供 PersistentVolumes。如果你的集群没有配置成这样，在开始本教程前，你需要手动准备三个 20 GiB 的卷。
教程目标 在学习本教程后，你将熟悉下列内容。
 如何使用 StatefulSet 部署一个 ZooKeeper ensemble。 如何使用 ConfigMaps 一致性配置 ensemble。 如何在 ensemble 中 分布 ZooKeeper 服务的部署。 如何在计划维护中使用 PodDisruptionBudgets 确保服务可用性。  ZooKeeper 基础 Apache ZooKeeper 是一个分布式的开源协调服务，用于分布式系统。ZooKeeper 允许你读取、写入数据和发现数据更新。数据按层次结构组织在文件系统中，并复制到 ensemble（一个 ZooKeeper 服务的集合） 中所有的 ZooKeeper 服务。对数据的所有操作都是原子的和顺序一致的。ZooKeeper 通过 Zab 一致性协议在 ensemble 的所有服务之间复制一个状态机来确保这个特性。"><meta name=twitter:description content="本教程展示了在 Kubernetes 上使用 PodDisruptionBudgets 和 PodAntiAffinity 特性运行 Apache Zookeeper。
准备开始 在开始本教程前，你应该熟悉以下 Kubernetes 概念。
 Pods Cluster DNS Headless Services PersistentVolumes PersistentVolume Provisioning ConfigMaps StatefulSets PodDisruptionBudgets PodAntiAffinity kubectl CLI  你需要一个至少包含四个节点的集群，每个节点至少 2 CPUs 和 4 GiB 内存。在本教程中你将会 cordon 和 drain 集群的节点。这意味着集群节点上所有的 Pods 将会被终止并移除。这些节点也会暂时变为不可调度。在本教程中你应该使用一个独占的集群，或者保证你造成的干扰不会影响其它租户。
本教程假设你的集群配置为动态的提供 PersistentVolumes。如果你的集群没有配置成这样，在开始本教程前，你需要手动准备三个 20 GiB 的卷。
教程目标 在学习本教程后，你将熟悉下列内容。
 如何使用 StatefulSet 部署一个 ZooKeeper ensemble。 如何使用 ConfigMaps 一致性配置 ensemble。 如何在 ensemble 中 分布 ZooKeeper 服务的部署。 如何在计划维护中使用 PodDisruptionBudgets 确保服务可用性。  ZooKeeper 基础 Apache ZooKeeper 是一个分布式的开源协调服务，用于分布式系统。ZooKeeper 允许你读取、写入数据和发现数据更新。数据按层次结构组织在文件系统中，并复制到 ensemble（一个 ZooKeeper 服务的集合） 中所有的 ZooKeeper 服务。对数据的所有操作都是原子的和顺序一致的。ZooKeeper 通过 Zab 一致性协议在 ensemble 的所有服务之间复制一个状态机来确保这个特性。"><meta property="og:url" content="https://kubernetes.io/zh/docs/tutorials/stateful-application/zookeeper/"><meta property="og:title" content="运行 ZooKeeper， 一个 CP 分布式系统"><meta name=twitter:title content="运行 ZooKeeper， 一个 CP 分布式系统"><meta name=twitter:image content="https://kubernetes.io/images/favicon.png"><meta name=twitter:image:alt content="Kubernetes"><meta property="og:image" content="/images/kubernetes-horizontal-color.png"><meta property="og:type" content="article"><script src=/js/jquery-ui-1.12.1.min.js></script><script src=/js/sweetalert-2.1.2.min.js></script><script src=/js/script.js></script><title>运行 ZooKeeper， 一个 CP 分布式系统 | Kubernetes</title></head><body class="td-page td-documentation"><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-row td-navbar" data-auto-burger=primary><a class=navbar-brand href=/zh/></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-2 mb-lg-0"><a class="nav-link active" href=/zh/docs/>文档</span></a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/zh/blog/>Kubernetes 博客</span></a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/zh/training/>培训</span></a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/zh/partners/>合作伙伴</span></a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/zh/community/>社区</span></a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/zh/case-studies/>案例分析</span></a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Versions</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=https://kubernetes.io>v1.22</a>
<a class=dropdown-item href=https://v1-21.docs.kubernetes.io>v1.21</a>
<a class=dropdown-item href=https://v1-20.docs.kubernetes.io>v1.20</a>
<a class=dropdown-item href=https://v1-19.docs.kubernetes.io>v1.19</a>
<a class=dropdown-item href=https://v1-18.docs.kubernetes.io>v1.18</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdownMenuLink role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>中文 Chinese</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/docs/tutorials/stateful-application/zookeeper/>English</a>
<a class=dropdown-item href=/ko/docs/tutorials/stateful-application/zookeeper/>한국어 Korean</a></div></li></ul></div><button id=hamburger onclick=kub.toggleMenu() data-auto-burger-exclude><div></div></button></nav><div class=header-filler></div></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-md-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" name=q placeholder="&#xf002 搜索" aria-label=搜索 autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3"><ul><li class="collapse show" id=zh-docs><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/home/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">主页</a></li><ul><li class=collapse id=zh-docs-home><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-home-supported-doc-versions href=/zh/docs/home/supported-doc-versions/>Kubernetes 文档支持的版本</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/setup/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">入门</a></li><ul><li class=collapse id=zh-docs-setup><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/setup/release/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Kubernetes 发行说明和版本偏差</a></li><ul><li class=collapse id=zh-docs-setup-release><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-release-notes href=/zh/docs/setup/release/notes/>v1.18 发布说明</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-release-version-skew-policy href=/zh/docs/setup/release/version-skew-policy/>Kubernetes 版本及版本倾斜支持策略</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/setup/learning-environment/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">学习环境</a></li><ul><li class=collapse id=zh-docs-setup-learning-environment><a class="td-sidebar-link td-sidebar-link__page" id=m-docs-setup-learning-environment-kind target=_blank href=/docs/setup/learning-environment/kind/>Installing Kubernetes with Kind <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-learning-environment-minikube href=/zh/docs/setup/learning-environment/minikube/>使用 Minikube 安装 Kubernetes</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-independent-create-cluster-kubeadm href=/zh/docs/setup/independent/create-cluster-kubeadm/>使用 kubeadm 创建一个单主集群</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/setup/production-environment/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">生产环境</a></li><ul><li class=collapse id=zh-docs-setup-production-environment><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-container-runtimes href=/zh/docs/setup/production-environment/container-runtimes/>容器运行时</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/setup/production-environment/turnkey/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Turnkey 云解决方案</a></li><ul><li class=collapse id=zh-docs-setup-production-environment-turnkey><a class="td-sidebar-link td-sidebar-link__page" id=m-docs-setup-production-environment-turnkey-gce target=_blank href=/docs/setup/production-environment/turnkey/gce/>Running Kubernetes on Google Compute Engine <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-turnkey-icp href=/zh/docs/setup/production-environment/turnkey/icp/>使用 IBM Cloud Private 在多个云上运行 Kubernetes</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-turnkey-aws href=/zh/docs/setup/production-environment/turnkey/aws/>在 AWS EC2 上运行 Kubernetes</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-turnkey-azure href=/zh/docs/setup/production-environment/turnkey/azure/>在 Azure 上运行 Kubernetes</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-turnkey-clc href=/zh/docs/setup/production-environment/turnkey/clc/>在 CenturyLink Cloud 上运行 Kubernetes</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-turnkey-tencent href=/zh/docs/setup/production-environment/turnkey/tencent/>在腾讯云容器服务上运行 Kubernetes</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-turnkey-alibaba-cloud href=/zh/docs/setup/production-environment/turnkey/alibaba-cloud/>在阿里云上运行 Kubernetes</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/setup/production-environment/tools/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">使用部署工具安装 Kubernetes</a></li><ul><li class=collapse id=zh-docs-setup-production-environment-tools><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/setup/production-environment/tools/kubeadm/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">使用 kubeadm 引导集群</a></li><ul><li class=collapse id=zh-docs-setup-production-environment-tools-kubeadm><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-tools-kubeadm-install-kubeadm href=/zh/docs/setup/production-environment/tools/kubeadm/install-kubeadm/>安装 kubeadm</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-tools-kubeadm-troubleshooting-kubeadm href=/zh/docs/setup/production-environment/tools/kubeadm/troubleshooting-kubeadm/>对 kubeadm 进行故障排查</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-setup-production-environment-tools-kubeadm-create-cluster-kubeadm target=_blank href=/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/>Creating a cluster with kubeadm <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-tools-kubeadm-control-plane-flags href=/zh/docs/setup/production-environment/tools/kubeadm/control-plane-flags/>使用 kubeadm 定制控制平面配置</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-tools-kubeadm-ha-topology href=/zh/docs/setup/production-environment/tools/kubeadm/ha-topology/>高可用拓扑选项</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-tools-kubeadm-high-availability href=/zh/docs/setup/production-environment/tools/kubeadm/high-availability/>利用 kubeadm 创建高可用集群</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-tools-kubeadm-setup-ha-etcd-with-kubeadm href=/zh/docs/setup/production-environment/tools/kubeadm/setup-ha-etcd-with-kubeadm/>使用 kubeadm 创建一个高可用 etcd 集群</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-tools-kubeadm-kubelet-integration href=/zh/docs/setup/production-environment/tools/kubeadm/kubelet-integration/>使用 kubeadm 配置集群中的每个 kubelet</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-tools-kubeadm-self-hosting href=/zh/docs/setup/production-environment/tools/kubeadm/self-hosting/>配置您的 kubernetes 集群以自托管控制平台</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-tools-kops href=/zh/docs/setup/production-environment/tools/kops/>使用 Kops 安装 Kubernetes</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-setup-production-environment-tools-kubespray target=_blank href=/docs/setup/production-environment/tools/kubespray/>Installing Kubernetes with Kubespray <small>(EN)</small></a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/setup/production-environment/on-premises-vm/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">本地 VMs</a></li><ul><li class=collapse id=zh-docs-setup-production-environment-on-premises-vm><a class="td-sidebar-link td-sidebar-link__page" id=m-docs-setup-production-environment-on-premises-vm-cloudstack target=_blank href=/docs/setup/production-environment/on-premises-vm/cloudstack/>Cloudstack <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-on-premises-vm-dcos href=/zh/docs/setup/production-environment/on-premises-vm/dcos/>DC/OS 上的 Kubernetes</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-on-premises-vm-ovirt href=/zh/docs/setup/production-environment/on-premises-vm/ovirt/>oVirt</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/setup/production-environment/windows/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Windows Kubernetes</a></li><ul><li class=collapse id=zh-docs-setup-production-environment-windows><a class="td-sidebar-link td-sidebar-link__page" id=m-docs-setup-production-environment-windows-intro-windows-in-kubernetes target=_blank href=/docs/setup/production-environment/windows/intro-windows-in-kubernetes/>Intro to Windows support in Kubernetes <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-production-environment-windows-user-guide-windows-containers href=/zh/docs/setup/production-environment/windows/user-guide-windows-containers/>Kubernetes 中调度 Windows 容器的指南</a></li></ul></ul></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/setup/best-practices/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">最佳实践</a></li><ul><li class=collapse id=zh-docs-setup-best-practices><a class="td-sidebar-link td-sidebar-link__page" id=m-docs-setup-best-practices-multiple-zones target=_blank href=/docs/setup/best-practices/multiple-zones/>Running in multiple zones <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-best-practices-cluster-large href=/zh/docs/setup/best-practices/cluster-large/>创建大型集群</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-best-practices-node-conformance href=/zh/docs/setup/best-practices/node-conformance/>校验节点设置</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-setup-best-practices-certificates href=/zh/docs/setup/best-practices/certificates/>PKI 证书和要求</a></li></ul></ul></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/contribute/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">贡献新内容</a></li><ul><li class=collapse id=zh-docs-contribute><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-suggest-improvements href=/zh/docs/contribute/suggest-improvements/>提出内容改进建议</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/contribute/new-content/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">贡献新内容</a></li><ul><li class=collapse id=zh-docs-contribute-new-content><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-new-content-overview href=/zh/docs/contribute/new-content/overview/>概述</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-new-content-open-a-pr href=/zh/docs/contribute/new-content/open-a-pr/>发起拉取请求（PR）</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-new-content-new-features href=/zh/docs/contribute/new-content/new-features/>为发行版本撰写文档</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-new-content-blogs-case-studies href=/zh/docs/contribute/new-content/blogs-case-studies/>博客和案例分析</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/contribute/review/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">评阅变更</a></li><ul><li class=collapse id=zh-docs-contribute-review><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-review-reviewing-prs href=/zh/docs/contribute/review/reviewing-prs/>评阅 PRs</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-review-for-approvers href=/zh/docs/contribute/review/for-approvers/>评阅人和批准人</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-localization href=/zh/docs/contribute/localization/>本地化 Kubernetes 文档</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/contribute/participate/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">参与 SIG Docs</a></li><ul><li class=collapse id=zh-docs-contribute-participate><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-participate-roles-and-responsibilities href=/zh/docs/contribute/participate/roles-and-responsibilities/>角色与责任</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-participate-pr-wranglers href=/zh/docs/contribute/participate/pr-wranglers/>PR 管理者</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/contribute/generate-ref-docs/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">参考文档概述</a></li><ul><li class=collapse id=zh-docs-contribute-generate-ref-docs><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-generate-ref-docs-contribute-upstream href=/zh/docs/contribute/generate-ref-docs/contribute-upstream/>为上游 Kubernetes 代码库做出贡献</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-generate-ref-docs-quickstart href=/zh/docs/contribute/generate-ref-docs/quickstart/>快速入门</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-generate-ref-docs-kubernetes-api href=/zh/docs/contribute/generate-ref-docs/kubernetes-api/>为 Kubernetes API 生成参考文档</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-generate-ref-docs-kubectl href=/zh/docs/contribute/generate-ref-docs/kubectl/>为 kubectl 命令集生成参考文档</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-generate-ref-docs-kubernetes-components href=/zh/docs/contribute/generate-ref-docs/kubernetes-components/>为 Kubernetes 组件和工具生成参考文档</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-generate-ref-docs-prerequisites-ref-docs href=/zh/docs/contribute/generate-ref-docs/prerequisites-ref-docs/></a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/contribute/style/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">文档样式概述</a></li><ul><li class=collapse id=zh-docs-contribute-style><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-style-content-guide href=/zh/docs/contribute/style/content-guide/>内容指南</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-style-style-guide href=/zh/docs/contribute/style/style-guide/>样式指南</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-style-write-new-topic href=/zh/docs/contribute/style/write-new-topic/>撰写新主题</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-style-page-content-types href=/zh/docs/contribute/style/page-content-types/>页面内容类型</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-style-content-organization href=/zh/docs/contribute/style/content-organization/>内容组织</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-style-hugo-shortcodes href=/zh/docs/contribute/style/hugo-shortcodes/>定制 Hugo 短代码</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-contribute-advanced href=/zh/docs/contribute/advanced/>高级贡献</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">概念</a></li><ul><li class=collapse id=zh-docs-concepts><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/overview/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">概述</a></li><ul><li class=collapse id=zh-docs-concepts-overview><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-overview-what-is-kubernetes href=/zh/docs/concepts/overview/what-is-kubernetes/>Kubernetes 是什么？</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-overview-components href=/zh/docs/concepts/overview/components/>Kubernetes 组件</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-overview-kubernetes-api href=/zh/docs/concepts/overview/kubernetes-api/>Kubernetes API</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/overview/working-with-objects/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">使用 Kubernetes 对象</a></li><ul><li class=collapse id=zh-docs-concepts-overview-working-with-objects><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-overview-working-with-objects-kubernetes-objects href=/zh/docs/concepts/overview/working-with-objects/kubernetes-objects/>理解 Kubernetes 对象</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-overview-working-with-objects-object-management href=/zh/docs/concepts/overview/working-with-objects/object-management/>Kubernetes 对象管理</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-overview-working-with-objects-names href=/zh/docs/concepts/overview/working-with-objects/names/>对象名称和 IDs</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-overview-working-with-objects-namespaces href=/zh/docs/concepts/overview/working-with-objects/namespaces/>名字空间</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-overview-working-with-objects-labels href=/zh/docs/concepts/overview/working-with-objects/labels/>标签和选择算符</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-overview-working-with-objects-annotations href=/zh/docs/concepts/overview/working-with-objects/annotations/>注解</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-overview-working-with-objects-field-selectors href=/zh/docs/concepts/overview/working-with-objects/field-selectors/>字段选择器</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-overview-working-with-objects-common-labels href=/zh/docs/concepts/overview/working-with-objects/common-labels/>推荐使用的标签</a></li></ul></ul></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/architecture/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Kubernetes 架构</a></li><ul><li class=collapse id=zh-docs-concepts-architecture><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-architecture-nodes href=/zh/docs/concepts/architecture/nodes/>节点</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-architecture-control-plane-node-communication href=/zh/docs/concepts/architecture/control-plane-node-communication/>控制面到节点通信</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-architecture-cloud-controller href=/zh/docs/concepts/architecture/cloud-controller/>云控制器管理器的基础概念</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-architecture-controller href=/zh/docs/concepts/architecture/controller/>控制器</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/containers/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">容器</a></li><ul><li class=collapse id=zh-docs-concepts-containers><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-containers-images href=/zh/docs/concepts/containers/images/>镜像</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-containers-container-environment href=/zh/docs/concepts/containers/container-environment/>容器环境</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-containers-runtime-class href=/zh/docs/concepts/containers/runtime-class/>容器运行时类(Runtime Class)</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-containers-container-lifecycle-hooks href=/zh/docs/concepts/containers/container-lifecycle-hooks/>容器生命周期回调</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/workloads/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">工作负载</a></li><ul><li class=collapse id=zh-docs-concepts-workloads><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/workloads/pods/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Pods</a></li><ul><li class=collapse id=zh-docs-concepts-workloads-pods><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-workloads-pods-pod-lifecycle href=/zh/docs/concepts/workloads/pods/pod-lifecycle/>Pod 的生命周期</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-workloads-pods-podpreset href=/zh/docs/concepts/workloads/pods/podpreset/>Pod Preset</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-workloads-pods-pod-topology-spread-constraints href=/zh/docs/concepts/workloads/pods/pod-topology-spread-constraints/>Pod 拓扑扩展约束</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-workloads-pods-disruptions href=/zh/docs/concepts/workloads/pods/disruptions/>干扰（Disruptions）</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-workloads-pods-ephemeral-containers href=/zh/docs/concepts/workloads/pods/ephemeral-containers/>临时容器</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-workloads-pods-init-containers href=/zh/docs/concepts/workloads/pods/init-containers/>Init 容器</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/workloads/controllers/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">控制器</a></li><ul><li class=collapse id=zh-docs-concepts-workloads-controllers><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-workloads-controllers-replicaset href=/zh/docs/concepts/workloads/controllers/replicaset/>ReplicaSet</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-workloads-controllers-replicationcontroller href=/zh/docs/concepts/workloads/controllers/replicationcontroller/>ReplicationController</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-workloads-controllers-deployment href=/zh/docs/concepts/workloads/controllers/deployment/>Deployments</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-workloads-controllers-statefulset href=/zh/docs/concepts/workloads/controllers/statefulset/>StatefulSets</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-workloads-controllers-daemonset href=/zh/docs/concepts/workloads/controllers/daemonset/>DaemonSet</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-workloads-controllers-job href=/zh/docs/concepts/workloads/controllers/job/>Jobs</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-workloads-controllers-ttlafterfinished href=/zh/docs/concepts/workloads/controllers/ttlafterfinished/>已完成资源的 TTL 控制器</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-workloads-controllers-garbage-collection href=/zh/docs/concepts/workloads/controllers/garbage-collection/>垃圾收集</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-workloads-controllers-cron-jobs href=/zh/docs/concepts/workloads/controllers/cron-jobs/>CronJob</a></li></ul></ul></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/storage/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">存储</a></li><ul><li class=collapse id=zh-docs-concepts-storage><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-storage-volumes href=/zh/docs/concepts/storage/volumes/>卷</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-concepts-storage-persistent-volumes target=_blank href=/docs/concepts/storage/persistent-volumes/>Persistent Volumes <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-storage-volume-snapshots href=/zh/docs/concepts/storage/volume-snapshots/>卷快照</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-storage-volume-pvc-datasource href=/zh/docs/concepts/storage/volume-pvc-datasource/>CSI 卷克隆</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-storage-volume-snapshot-classes href=/zh/docs/concepts/storage/volume-snapshot-classes/>卷快照类</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-storage-storage-classes href=/zh/docs/concepts/storage/storage-classes/>存储类</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-storage-dynamic-provisioning href=/zh/docs/concepts/storage/dynamic-provisioning/>动态卷供应</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-storage-storage-limits href=/zh/docs/concepts/storage/storage-limits/>特定于节点的卷数限制</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/configuration/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">配置</a></li><ul><li class=collapse id=zh-docs-concepts-configuration><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-configuration-overview href=/zh/docs/concepts/configuration/overview/>配置最佳实践</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-configuration-configmap href=/zh/docs/concepts/configuration/configmap/>ConfigMap</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-configuration-pod-overhead href=/zh/docs/concepts/configuration/pod-overhead/>Pod 开销</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-configuration-secret href=/zh/docs/concepts/configuration/secret/>Secret</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-configuration-manage-resources-containers href=/zh/docs/concepts/configuration/manage-resources-containers/>为容器管理资源</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-configuration-resource-bin-packing href=/zh/docs/concepts/configuration/resource-bin-packing/>扩展资源的资源装箱</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-configuration-organize-cluster-access-kubeconfig href=/zh/docs/concepts/configuration/organize-cluster-access-kubeconfig/>使用 kubeconfig 文件组织集群访问</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-concepts-configuration-pod-priority-preemption target=_blank href=/docs/concepts/configuration/pod-priority-preemption/>Pod Priority and Preemption <small>(EN)</small></a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/services-networking/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">服务、负载均衡和联网</a></li><ul><li class=collapse id=zh-docs-concepts-services-networking><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-services-networking-service-topology href=/zh/docs/concepts/services-networking/service-topology/>Service 拓扑</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-services-networking-service href=/zh/docs/concepts/services-networking/service/>服务</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-services-networking-endpoint-slices href=/zh/docs/concepts/services-networking/endpoint-slices/>端点切片（Endpoint Slices）</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-services-networking-dns-pod-service href=/zh/docs/concepts/services-networking/dns-pod-service/>Pod 与 Service 的 DNS</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-services-networking-connect-applications-service href=/zh/docs/concepts/services-networking/connect-applications-service/>使用 Service 连接到应用</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-services-networking-ingress href=/zh/docs/concepts/services-networking/ingress/>Ingress</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-services-networking-ingress-controllers href=/zh/docs/concepts/services-networking/ingress-controllers/>Ingress 控制器</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-services-networking-network-policies href=/zh/docs/concepts/services-networking/network-policies/>网络策略</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-services-networking-add-entries-to-pod-etc-hosts-with-host-aliases href=/zh/docs/concepts/services-networking/add-entries-to-pod-etc-hosts-with-host-aliases/>使用 HostAliases 向 Pod /etc/hosts 文件添加条目</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-services-networking-dual-stack href=/zh/docs/concepts/services-networking/dual-stack/>IPv4/IPv6 双协议栈</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/security/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">安全</a></li><ul><li class=collapse id=zh-docs-concepts-security><a class="td-sidebar-link td-sidebar-link__page" id=m-docs-concepts-security-overview target=_blank href=/docs/concepts/security/overview/>Overview of Cloud Native Security <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-concepts-security-pod-security-standards target=_blank href=/docs/concepts/security/pod-security-standards/>Pod Security Standards <small>(EN)</small></a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/scheduling-eviction/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">调度和驱逐(Scheduling and Eviction)</a></li><ul><li class=collapse id=zh-docs-concepts-scheduling-eviction><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-scheduling-eviction-taint-and-toleration href=/zh/docs/concepts/scheduling-eviction/taint-and-toleration/>污点和容忍度</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-scheduling-eviction-kube-scheduler href=/zh/docs/concepts/scheduling-eviction/kube-scheduler/>Kubernetes 调度器</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-scheduling-eviction-assign-pod-node href=/zh/docs/concepts/scheduling-eviction/assign-pod-node/>将 Pod 分配给节点</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-scheduling-eviction-scheduling-framework href=/zh/docs/concepts/scheduling-eviction/scheduling-framework/>调度框架</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-scheduling-eviction-scheduler-perf-tuning href=/zh/docs/concepts/scheduling-eviction/scheduler-perf-tuning/>调度器性能调优</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/cluster-administration/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">集群管理</a></li><ul><li class=collapse id=zh-docs-concepts-cluster-administration><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-cluster-administration-certificates href=/zh/docs/concepts/cluster-administration/certificates/>证书</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-cluster-administration-cloud-providers href=/zh/docs/concepts/cluster-administration/cloud-providers/>云驱动</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-cluster-administration-manage-deployment href=/zh/docs/concepts/cluster-administration/manage-deployment/>管理资源</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-cluster-administration-networking href=/zh/docs/concepts/cluster-administration/networking/>集群网络系统</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-cluster-administration-monitoring href=/zh/docs/concepts/cluster-administration/monitoring/>Kubernetes 控制面的指标</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-cluster-administration-logging href=/zh/docs/concepts/cluster-administration/logging/>日志架构</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-cluster-administration-kubelet-garbage-collection href=/zh/docs/concepts/cluster-administration/kubelet-garbage-collection/>配置 kubelet 垃圾回收策略</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-cluster-administration-proxies href=/zh/docs/concepts/cluster-administration/proxies/>Kubernetes 中的代理</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-cluster-administration-controller-metrics href=/zh/docs/concepts/cluster-administration/controller-metrics/>控制器管理器指标</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-concepts-cluster-administration-flow-control target=_blank href=/docs/concepts/cluster-administration/flow-control/>API Priority and Fairness <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-cluster-administration-addons href=/zh/docs/concepts/cluster-administration/addons/>安装扩展（Addons）</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/extend-kubernetes/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">扩展 Kubernetes</a></li><ul><li class=collapse id=zh-docs-concepts-extend-kubernetes><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-extend-kubernetes-extend-cluster href=/zh/docs/concepts/extend-kubernetes/extend-cluster/>扩展 Kubernetes 集群</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/extend-kubernetes/api-extension/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">扩展 Kubernetes API</a></li><ul><li class=collapse id=zh-docs-concepts-extend-kubernetes-api-extension><a class="td-sidebar-link td-sidebar-link__page" id=m-docs-concepts-extend-kubernetes-api-extension-custom-resources target=_blank href=/docs/concepts/extend-kubernetes/api-extension/custom-resources/>Custom Resources <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-extend-kubernetes-api-extension-apiserver-aggregation href=/zh/docs/concepts/extend-kubernetes/api-extension/apiserver-aggregation/>通过聚合层扩展 Kubernetes API</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-extend-kubernetes-operator href=/zh/docs/concepts/extend-kubernetes/operator/>Operator 模式</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/extend-kubernetes/compute-storage-net/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">计算、存储和网络扩展</a></li><ul><li class=collapse id=zh-docs-concepts-extend-kubernetes-compute-storage-net><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-extend-kubernetes-compute-storage-net-network-plugins href=/zh/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/>网络插件</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-extend-kubernetes-compute-storage-net-device-plugins href=/zh/docs/concepts/extend-kubernetes/compute-storage-net/device-plugins/>设备插件</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-extend-kubernetes-service-catalog href=/zh/docs/concepts/extend-kubernetes/service-catalog/>服务目录</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/concepts/policy/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">策略</a></li><ul><li class=collapse id=zh-docs-concepts-policy><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-policy-resource-quotas href=/zh/docs/concepts/policy/resource-quotas/>资源配额</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-policy-limit-range href=/zh/docs/concepts/policy/limit-range/>限制范围</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-concepts-policy-pod-security-policy href=/zh/docs/concepts/policy/pod-security-policy/>Pod 安全策略</a></li></ul></ul></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">任务</a></li><ul><li class=collapse id=zh-docs-tasks><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/tools/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">安装工具</a></li><ul><li class=collapse id=zh-docs-tasks-tools><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-tools-install-kubectl href=/zh/docs/tasks/tools/install-kubectl/>安装并配置 kubectl</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-tools-install-minikube href=/zh/docs/tasks/tools/install-minikube/>安装 Minikube</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/administer-cluster/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">管理集群</a></li><ul><li class=collapse id=zh-docs-tasks-administer-cluster><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/administer-cluster/kubeadm/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">用 kubeadm 进行管理</a></li><ul><li class=collapse id=zh-docs-tasks-administer-cluster-kubeadm><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-kubeadm-kubeadm-upgrade href=/zh/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade/>升级 kubeadm 集群</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tasks-administer-cluster-kubeadm-adding-windows-nodes target=_blank href=/docs/tasks/administer-cluster/kubeadm/adding-windows-nodes/>Adding Windows nodes <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tasks-administer-cluster-kubeadm-upgrading-windows-nodes target=_blank href=/docs/tasks/administer-cluster/kubeadm/upgrading-windows-nodes/>Upgrading Windows nodes <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-kubeadm-kubeadm-certs href=/zh/docs/tasks/administer-cluster/kubeadm/kubeadm-certs/>使用 kubeadm 进行证书管理</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/administer-cluster/manage-resources/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">管理内存，CPU 和 API 资源</a></li><ul><li class=collapse id=zh-docs-tasks-administer-cluster-manage-resources><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-manage-resources-memory-default-namespace href=/zh/docs/tasks/administer-cluster/manage-resources/memory-default-namespace/>为命名空间配置默认的内存请求和限制</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-manage-resources-cpu-default-namespace href=/zh/docs/tasks/administer-cluster/manage-resources/cpu-default-namespace/>为命名空间配置默认的 CPU 请求和限制</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-manage-resources-memory-constraint-namespace href=/zh/docs/tasks/administer-cluster/manage-resources/memory-constraint-namespace/>配置命名空间的最小和最大内存约束</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-manage-resources-cpu-constraint-namespace href=/zh/docs/tasks/administer-cluster/manage-resources/cpu-constraint-namespace/>为命名空间配置 CPU 最小和最大约束</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-manage-resources-quota-memory-cpu-namespace href=/zh/docs/tasks/administer-cluster/manage-resources/quota-memory-cpu-namespace/>为命名空间配置内存和 CPU 配额</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-manage-resources-quota-pod-namespace href=/zh/docs/tasks/administer-cluster/manage-resources/quota-pod-namespace/>配置命名空间下 Pod 配额</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/administer-cluster/network-policy-provider/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">安装网络规则驱动</a></li><ul><li class=collapse id=zh-docs-tasks-administer-cluster-network-policy-provider><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-network-policy-provider-calico-network-policy href=/zh/docs/tasks/administer-cluster/network-policy-provider/calico-network-policy/>使用 Calico 提供 NetworkPolicy</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-network-policy-provider-cilium-network-policy href=/zh/docs/tasks/administer-cluster/network-policy-provider/cilium-network-policy/>使用 Cilium 提供 NetworkPolicy</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-network-policy-provider-kube-router-network-policy href=/zh/docs/tasks/administer-cluster/network-policy-provider/kube-router-network-policy/>使用 kube-router 提供 NetworkPolicy</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-network-policy-provider-romana-network-policy href=/zh/docs/tasks/administer-cluster/network-policy-provider/romana-network-policy/>使用 Romana 提供 NetworkPolicy</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-network-policy-provider-weave-network-policy href=/zh/docs/tasks/administer-cluster/network-policy-provider/weave-network-policy/>使用 Weave Net 提供 NetworkPolicy</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tasks-administer-cluster-enabling-service-topology target=_blank href=/docs/tasks/administer-cluster/enabling-service-topology/>Enabling Service Topology <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-ip-masq-agent href=/zh/docs/tasks/administer-cluster/ip-masq-agent/>IP Masquerade Agent 用户指南</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-running-cloud-controller href=/zh/docs/tasks/administer-cluster/running-cloud-controller/>Kubernetes 云管理控制器</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tasks-administer-cluster-safely-drain-node target=_blank href=/docs/tasks/administer-cluster/safely-drain-node/>Safely Drain a Node while Respecting the PodDisruptionBudget <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-configure-upgrade-etcd href=/zh/docs/tasks/administer-cluster/configure-upgrade-etcd/>为 Kubernetes 运行 etcd 集群</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-reserve-compute-resources href=/zh/docs/tasks/administer-cluster/reserve-compute-resources/>为系统守护进程预留计算资源</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-extended-resource-node href=/zh/docs/tasks/administer-cluster/extended-resource-node/>为节点发布扩展资源</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-coredns href=/zh/docs/tasks/administer-cluster/coredns/>使用 CoreDNS 进行服务发现</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-kms-provider href=/zh/docs/tasks/administer-cluster/kms-provider/>使用 KMS 提供商进行数据加密</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-access-cluster-api href=/zh/docs/tasks/administer-cluster/access-cluster-api/>使用 Kubernetes API 访问集群</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-securing-a-cluster href=/zh/docs/tasks/administer-cluster/securing-a-cluster/>保护集群安全</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-guaranteed-scheduling-critical-addon-pods href=/zh/docs/tasks/administer-cluster/guaranteed-scheduling-critical-addon-pods/>关键插件 Pod 的调度保证</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-namespaces-walkthrough href=/zh/docs/tasks/administer-cluster/namespaces-walkthrough/>名字空间演练</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-enabling-endpointslices href=/zh/docs/tasks/administer-cluster/enabling-endpointslices/>启用端点切片</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-nodelocaldns href=/zh/docs/tasks/administer-cluster/nodelocaldns/>在 Kubernetes 集群中使用 NodeLocal DNSCache</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-sysctl-cluster href=/zh/docs/tasks/administer-cluster/sysctl-cluster/>在 Kubernetes 集群中使用 sysctl</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-reconfigure-kubelet href=/zh/docs/tasks/administer-cluster/reconfigure-kubelet/>在运行中的集群上重新配置节点的 kubelet</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-declare-network-policy href=/zh/docs/tasks/administer-cluster/declare-network-policy/>声明网络策略</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-developing-cloud-controller-manager href=/zh/docs/tasks/administer-cluster/developing-cloud-controller-manager/>开发云控制器管理器</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-cpu-management-policies href=/zh/docs/tasks/administer-cluster/cpu-management-policies/>控制节点上的 CPU 管理策略</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-topology-manager href=/zh/docs/tasks/administer-cluster/topology-manager/>控制节点上的拓扑管理策略</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-highly-available-master href=/zh/docs/tasks/administer-cluster/highly-available-master/>搭建高可用的 Kubernetes Masters</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-change-default-storage-class href=/zh/docs/tasks/administer-cluster/change-default-storage-class/>改变默认 StorageClass</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-change-pv-reclaim-policy href=/zh/docs/tasks/administer-cluster/change-pv-reclaim-policy/>更改 PersistentVolume 的回收策略</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-dns-horizontal-autoscaling href=/zh/docs/tasks/administer-cluster/dns-horizontal-autoscaling/>自动扩缩集群 DNS 服务</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-dns-custom-nameservers href=/zh/docs/tasks/administer-cluster/dns-custom-nameservers/>自定义 DNS 服务</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-access-cluster-services href=/zh/docs/tasks/administer-cluster/access-cluster-services/>访问集群上运行的服务</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-dns-debugging-resolution href=/zh/docs/tasks/administer-cluster/dns-debugging-resolution/>调试 DNS 问题</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-namespaces href=/zh/docs/tasks/administer-cluster/namespaces/>通过命名空间共享集群</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-kubelet-config-file href=/zh/docs/tasks/administer-cluster/kubelet-config-file/>通过配置文件设置 Kubelet 参数</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-quota-api-object href=/zh/docs/tasks/administer-cluster/quota-api-object/>配置 API 对象配额</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-out-of-resource href=/zh/docs/tasks/administer-cluster/out-of-resource/>配置资源不足时的处理方式</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-limit-storage-consumption href=/zh/docs/tasks/administer-cluster/limit-storage-consumption/>限制存储消耗</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-cluster-management href=/zh/docs/tasks/administer-cluster/cluster-management/>集群管理</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-administer-cluster-encrypt-data href=/zh/docs/tasks/administer-cluster/encrypt-data/>静态加密 Secret 数据</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/configure-pod-container/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">配置 Pods 和容器</a></li><ul><li class=collapse id=zh-docs-tasks-configure-pod-container><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-assign-memory-resource href=/zh/docs/tasks/configure-pod-container/assign-memory-resource/>为容器和 Pod 分配内存资源</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tasks-configure-pod-container-configure-gmsa target=_blank href=/docs/tasks/configure-pod-container/configure-gmsa/>Configure GMSA for Windows Pods and containers <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-configure-runasusername href=/zh/docs/tasks/configure-pod-container/configure-runasusername/>为 Windows 的 Pod 和容器配置 RunAsUserName</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-assign-cpu-resource href=/zh/docs/tasks/configure-pod-container/assign-cpu-resource/>为容器和 Pods 分配 CPU 资源</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-quality-service-pod href=/zh/docs/tasks/configure-pod-container/quality-service-pod/>配置 Pod 的服务质量</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-extended-resource href=/zh/docs/tasks/configure-pod-container/extended-resource/>为容器分派扩展资源</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-configure-volume-storage href=/zh/docs/tasks/configure-pod-container/configure-volume-storage/>配置 Pod 以使用卷进行存储</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-configure-persistent-volume-storage href=/zh/docs/tasks/configure-pod-container/configure-persistent-volume-storage/>配置 Pod 以使用 PersistentVolume 作为存储</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-configure-projected-volume-storage href=/zh/docs/tasks/configure-pod-container/configure-projected-volume-storage/>配置 Pod 使用投射卷作存储</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tasks-configure-pod-container-security-context target=_blank href=/docs/tasks/configure-pod-container/security-context/>Configure a Security Context for a Pod or Container <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-configure-service-account href=/zh/docs/tasks/configure-pod-container/configure-service-account/>为 Pod 配置服务账户</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-pull-image-private-registry href=/zh/docs/tasks/configure-pod-container/pull-image-private-registry/>从私有仓库拉取镜像</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-configure-liveness-readiness-startup-probes href=/zh/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/>配置存活、就绪和启动探测器</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tasks-configure-pod-container-assign-pods-nodes-using-node-affinity target=_blank href=/docs/tasks/configure-pod-container/assign-pods-nodes-using-node-affinity/>Assign Pods to Nodes using Node Affinity <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-assign-pods-nodes href=/zh/docs/tasks/configure-pod-container/assign-pods-nodes/>将 Pod 分配给节点</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-configure-pod-initialization href=/zh/docs/tasks/configure-pod-container/configure-pod-initialization/>配置 Pod 初始化</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-attach-handler-lifecycle-event href=/zh/docs/tasks/configure-pod-container/attach-handler-lifecycle-event/>为容器的生命周期事件设置处理函数</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-configure-pod-configmap href=/zh/docs/tasks/configure-pod-container/configure-pod-configmap/>配置 Pod 使用 ConfigMap</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-share-process-namespace href=/zh/docs/tasks/configure-pod-container/share-process-namespace/>在 Pod 中的容器之间共享进程命名空间</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-static-pod href=/zh/docs/tasks/configure-pod-container/static-pod/>创建静态 Pod</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-configure-pod-container-translate-compose-kubernetes href=/zh/docs/tasks/configure-pod-container/translate-compose-kubernetes/>将 Docker Compose 文件转换为 Kubernetes 资源</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/manage-kubernetes-objects/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">管理 Kubernetes 对象</a></li><ul><li class=collapse id=zh-docs-tasks-manage-kubernetes-objects><a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tasks-manage-kubernetes-objects-declarative-config target=_blank href=/docs/tasks/manage-kubernetes-objects/declarative-config/>Declarative Management of Kubernetes Objects Using Configuration Files <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tasks-manage-kubernetes-objects-kustomization target=_blank href=/docs/tasks/manage-kubernetes-objects/kustomization/>Declarative Management of Kubernetes Objects Using Kustomize <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tasks-manage-kubernetes-objects-imperative-command target=_blank href=/docs/tasks/manage-kubernetes-objects/imperative-command/>Managing Kubernetes Objects Using Imperative Commands <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-manage-kubernetes-objects-imperative-config href=/zh/docs/tasks/manage-kubernetes-objects/imperative-config/>使用配置文件对 Kubernetes 对象进行命令式管理</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tasks-manage-kubernetes-objects-update-api-object-kubectl-patch target=_blank href=/docs/tasks/manage-kubernetes-objects/update-api-object-kubectl-patch/>Update API Objects in Place Using kubectl patch <small>(EN)</small></a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/inject-data-application/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">给应用注入数据</a></li><ul><li class=collapse id=zh-docs-tasks-inject-data-application><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-inject-data-application-define-command-argument-container href=/zh/docs/tasks/inject-data-application/define-command-argument-container/>为容器设置启动时要执行的命令和参数</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tasks-inject-data-application-define-interdependent-environment-variables target=_blank href=/docs/tasks/inject-data-application/define-interdependent-environment-variables/>Define Dependent Environment Variables <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-inject-data-application-define-environment-variable-container href=/zh/docs/tasks/inject-data-application/define-environment-variable-container/>为容器设置环境变量</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-inject-data-application-environment-variable-expose-pod-information href=/zh/docs/tasks/inject-data-application/environment-variable-expose-pod-information/>通过环境变量将 Pod 信息呈现给容器</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-inject-data-application-downward-api-volume-expose-pod-information href=/zh/docs/tasks/inject-data-application/downward-api-volume-expose-pod-information/>通过文件将 Pod 信息呈现给容器</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-inject-data-application-distribute-credentials-secure href=/zh/docs/tasks/inject-data-application/distribute-credentials-secure/>使用 Secret 安全地分发凭证</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-inject-data-application-podpreset href=/zh/docs/tasks/inject-data-application/podpreset/>使用 PodPreset 将信息注入 Pod</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/run-application/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">运行应用</a></li><ul><li class=collapse id=zh-docs-tasks-run-application><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-run-application-run-replicated-stateful-application href=/zh/docs/tasks/run-application/run-replicated-stateful-application/>运行一个有状态的应用程序</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-run-application-update-api-object-kubectl-patch href=/zh/docs/tasks/run-application/update-api-object-kubectl-patch/>使用 kubectl patch 更新 API 对象</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-run-application-delete-stateful-set href=/zh/docs/tasks/run-application/delete-stateful-set/>删除 StatefulSet</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-run-application-force-delete-stateful-set-pod href=/zh/docs/tasks/run-application/force-delete-stateful-set-pod/>强制删除 StatefulSet 类型的 Pods</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-run-application-horizontal-pod-autoscale href=/zh/docs/tasks/run-application/horizontal-pod-autoscale/>Pod 水平自动扩缩</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-run-application-horizontal-pod-autoscale-walkthrough href=/zh/docs/tasks/run-application/horizontal-pod-autoscale-walkthrough/>Horizontal Pod Autoscaler 演练</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-run-application-configure-pdb href=/zh/docs/tasks/run-application/configure-pdb/>为应用程序设置干扰预算（Disruption Budget）</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-run-application-run-stateless-application-deployment href=/zh/docs/tasks/run-application/run-stateless-application-deployment/>使用Deployment运行一个无状态应用</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-run-application-scale-stateful-set href=/zh/docs/tasks/run-application/scale-stateful-set/>扩缩 StatefulSet</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-run-application-run-single-instance-stateful-application href=/zh/docs/tasks/run-application/run-single-instance-stateful-application/>运行一个单实例有状态应用</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/job/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">运行 Jobs</a></li><ul><li class=collapse id=zh-docs-tasks-job><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-job-automated-tasks-with-cron-jobs href=/zh/docs/tasks/job/automated-tasks-with-cron-jobs/>使用 CronJob 运行自动化任务</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-job-parallel-processing-expansion href=/zh/docs/tasks/job/parallel-processing-expansion/>使用扩展进行并行处理</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-job-coarse-parallel-processing-work-queue href=/zh/docs/tasks/job/coarse-parallel-processing-work-queue/>使用工作队列进行粗粒度并行处理</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-job-fine-parallel-processing-work-queue href=/zh/docs/tasks/job/fine-parallel-processing-work-queue/>使用工作队列进行精细的并行处理</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/access-application-cluster/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">访问集群中的应用程序</a></li><ul><li class=collapse id=zh-docs-tasks-access-application-cluster><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-access-application-cluster-web-ui-dashboard href=/zh/docs/tasks/access-application-cluster/web-ui-dashboard/>Web 界面 (Dashboard)</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-access-application-cluster-access-cluster href=/zh/docs/tasks/access-application-cluster/access-cluster/>访问集群</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-access-application-cluster-port-forward-access-application-cluster href=/zh/docs/tasks/access-application-cluster/port-forward-access-application-cluster/>使用端口转发来访问集群中的应用</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-access-application-cluster-service-access-application-cluster href=/zh/docs/tasks/access-application-cluster/service-access-application-cluster/>使用服务来访问集群中的应用</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-access-application-cluster-connecting-frontend-backend href=/zh/docs/tasks/access-application-cluster/connecting-frontend-backend/>使用 Service 把前端连接到后端</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-access-application-cluster-create-external-load-balancer href=/zh/docs/tasks/access-application-cluster/create-external-load-balancer/>创建外部负载均衡器</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-access-application-cluster-configure-cloud-provider-firewall href=/zh/docs/tasks/access-application-cluster/configure-cloud-provider-firewall/>配置你的云平台防火墙</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-access-application-cluster-list-all-running-container-images href=/zh/docs/tasks/access-application-cluster/list-all-running-container-images/>列出集群中所有运行容器的镜像</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-access-application-cluster-ingress-minikube href=/zh/docs/tasks/access-application-cluster/ingress-minikube/>在 Minikube 环境中使用 NGINX Ingress 控制器配置 Ingress</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-access-application-cluster-configure-dns-cluster href=/zh/docs/tasks/access-application-cluster/configure-dns-cluster/>为集群配置 DNS</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-access-application-cluster-communicate-containers-same-pod-shared-volume href=/zh/docs/tasks/access-application-cluster/communicate-containers-same-pod-shared-volume/>同 Pod 内的容器使用共享卷通信</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-access-application-cluster-configure-access-multiple-clusters href=/zh/docs/tasks/access-application-cluster/configure-access-multiple-clusters/>配置对多集群的访问</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/debug-application-cluster/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">监控、日志和排错</a></li><ul><li class=collapse id=zh-docs-tasks-debug-application-cluster><a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tasks-debug-application-cluster-debug-running-pod target=_blank href=/docs/tasks/debug-application-cluster/debug-running-pod/>Debug Running Pods <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tasks-debug-application-cluster-logging-stackdriver target=_blank href=/docs/tasks/debug-application-cluster/logging-stackdriver/>Logging Using Stackdriver <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-events-stackdriver href=/zh/docs/tasks/debug-application-cluster/events-stackdriver/>StackDriver 中的事件</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-crictl href=/zh/docs/tasks/debug-application-cluster/crictl/>使用 crictl 对 Kubernetes 节点进行调试</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-logging-elasticsearch-kibana href=/zh/docs/tasks/debug-application-cluster/logging-elasticsearch-kibana/>使用 ElasticSearch 和 Kibana 进行日志管理</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-local-debugging href=/zh/docs/tasks/debug-application-cluster/local-debugging/>在本地开发和调试服务</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-audit href=/zh/docs/tasks/debug-application-cluster/audit/>审计</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-debug-application href=/zh/docs/tasks/debug-application-cluster/debug-application/>应用故障排查</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-debug-application-introspection href=/zh/docs/tasks/debug-application-cluster/debug-application-introspection/>应用自测与调试</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-troubleshooting href=/zh/docs/tasks/debug-application-cluster/troubleshooting/>排错</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-determine-reason-pod-failure href=/zh/docs/tasks/debug-application-cluster/determine-reason-pod-failure/>确定 Pod 失败的原因</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-monitor-node-health href=/zh/docs/tasks/debug-application-cluster/monitor-node-health/>节点健康监测</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-get-shell-running-container href=/zh/docs/tasks/debug-application-cluster/get-shell-running-container/>获取正在运行容器的 Shell</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-debug-init-containers href=/zh/docs/tasks/debug-application-cluster/debug-init-containers/>调试 Init 容器</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-debug-pod-replication-controller href=/zh/docs/tasks/debug-application-cluster/debug-pod-replication-controller/>调试 Pods 和 ReplicationControllers</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-debug-service href=/zh/docs/tasks/debug-application-cluster/debug-service/>调试 Service</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-debug-stateful-set href=/zh/docs/tasks/debug-application-cluster/debug-stateful-set/>调试StatefulSet</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-resource-metrics-pipeline href=/zh/docs/tasks/debug-application-cluster/resource-metrics-pipeline/>资源指标管道</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-resource-usage-monitoring href=/zh/docs/tasks/debug-application-cluster/resource-usage-monitoring/>资源监控工具</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-debug-application-cluster-debug-cluster href=/zh/docs/tasks/debug-application-cluster/debug-cluster/>集群故障排查</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/extend-kubernetes/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">扩展 Kubernetes</a></li><ul><li class=collapse id=zh-docs-tasks-extend-kubernetes><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/extend-kubernetes/custom-resources/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">使用自定义资源</a></li><ul><li class=collapse id=zh-docs-tasks-extend-kubernetes-custom-resources><a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tasks-extend-kubernetes-custom-resources-custom-resource-definitions target=_blank href=/docs/tasks/extend-kubernetes/custom-resources/custom-resource-definitions/>Extend the Kubernetes API with CustomResourceDefinitions <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-extend-kubernetes-custom-resources-custom-resource-definition-versioning href=/zh/docs/tasks/extend-kubernetes/custom-resources/custom-resource-definition-versioning/>用户自定义资源的版本</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-extend-kubernetes-configure-aggregation-layer href=/zh/docs/tasks/extend-kubernetes/configure-aggregation-layer/>配置聚合层</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-extend-kubernetes-setup-extension-api-server href=/zh/docs/tasks/extend-kubernetes/setup-extension-api-server/>安装一个扩展的 API server</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-extend-kubernetes-configure-multiple-schedulers href=/zh/docs/tasks/extend-kubernetes/configure-multiple-schedulers/>配置多个调度器</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-extend-kubernetes-http-proxy-access-api href=/zh/docs/tasks/extend-kubernetes/http-proxy-access-api/>使用 HTTP 代理访问 Kubernetes API</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tasks-extend-kubernetes-setup-konnectivity target=_blank href=/docs/tasks/extend-kubernetes/setup-konnectivity/>Set up Konnectivity service <small>(EN)</small></a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/tls/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">TLS</a></li><ul><li class=collapse id=zh-docs-tasks-tls><a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tasks-tls-manual-rotation-of-ca-certificates target=_blank href=/docs/tasks/tls/manual-rotation-of-ca-certificates/>Manual Rotation of CA Certificates <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-tls-certificate-rotation href=/zh/docs/tasks/tls/certificate-rotation/>为 kubelet 配置证书轮换</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-tls-managing-tls-in-a-cluster href=/zh/docs/tasks/tls/managing-tls-in-a-cluster/>管理集群中的 TLS 认证</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/manage-daemon/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">管理集群守护进程</a></li><ul><li class=collapse id=zh-docs-tasks-manage-daemon><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-manage-daemon-update-daemon-set href=/zh/docs/tasks/manage-daemon/update-daemon-set/>对 DaemonSet 执行滚动更新</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-manage-daemon-rollback-daemon-set href=/zh/docs/tasks/manage-daemon/rollback-daemon-set/>对 DaemonSet 执行回滚</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/service-catalog/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">安装服务目录</a></li><ul><li class=collapse id=zh-docs-tasks-service-catalog><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-service-catalog-install-service-catalog-using-helm href=/zh/docs/tasks/service-catalog/install-service-catalog-using-helm/>使用 Helm 安装 Service Catalog</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-service-catalog-install-service-catalog-using-sc href=/zh/docs/tasks/service-catalog/install-service-catalog-using-sc/>使用 SC 安装服务目录</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tasks/network/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">网络</a></li><ul><li class=collapse id=zh-docs-tasks-network><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-network-validate-dual-stack href=/zh/docs/tasks/network/validate-dual-stack/>验证 IPv4/IPv6 双协议栈</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-extend-kubectl-kubectl-plugins href=/zh/docs/tasks/extend-kubectl/kubectl-plugins/>用插件扩展 kubectl</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-manage-hugepages-scheduling-hugepages href=/zh/docs/tasks/manage-hugepages/scheduling-hugepages/>管理巨页（HugePages）</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tasks-manage-gpus-scheduling-gpus href=/zh/docs/tasks/manage-gpus/scheduling-gpus/>调度 GPUs</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tutorials/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">教程</a></li><ul><li class="collapse show" id=zh-docs-tutorials><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-hello-minikube href=/zh/docs/tutorials/hello-minikube/>你好 Minikube</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tutorials/kubernetes-basics/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">学习 Kubernetes 基础知识</a></li><ul><li class=collapse id=zh-docs-tutorials-kubernetes-basics><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tutorials/kubernetes-basics/create-cluster/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">创建集群</a></li><ul><li class=collapse id=zh-docs-tutorials-kubernetes-basics-create-cluster><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-kubernetes-basics-create-cluster-cluster-intro href=/zh/docs/tutorials/kubernetes-basics/create-cluster/cluster-intro/>使用 Minikube 创建集群</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-kubernetes-basics-create-cluster-cluster-interactive href=/zh/docs/tutorials/kubernetes-basics/create-cluster/cluster-interactive/>交互式教程 - 创建集群</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tutorials/kubernetes-basics/deploy-app/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">部署应用</a></li><ul><li class=collapse id=zh-docs-tutorials-kubernetes-basics-deploy-app><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-kubernetes-basics-deploy-app-deploy-intro href=/zh/docs/tutorials/kubernetes-basics/deploy-app/deploy-intro/>使用 kubectl 创建 Deployment</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-kubernetes-basics-deploy-app-deploy-interactive href=/zh/docs/tutorials/kubernetes-basics/deploy-app/deploy-interactive/>交互式教程 - 部署应用</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tutorials/kubernetes-basics/explore/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">了解你的应用</a></li><ul><li class=collapse id=zh-docs-tutorials-kubernetes-basics-explore><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-kubernetes-basics-explore-explore-intro href=/zh/docs/tutorials/kubernetes-basics/explore/explore-intro/>查看 pod 和工作节点</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-kubernetes-basics-explore-explore-interactive href=/zh/docs/tutorials/kubernetes-basics/explore/explore-interactive/>交互式教程-了解你的应用</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tutorials/kubernetes-basics/expose/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">公开地暴露你的应用</a></li><ul><li class=collapse id=zh-docs-tutorials-kubernetes-basics-expose><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-kubernetes-basics-expose-expose-intro href=/zh/docs/tutorials/kubernetes-basics/expose/expose-intro/>使用 Service 暴露您的应用</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-kubernetes-basics-expose-expose-interactive href=/zh/docs/tutorials/kubernetes-basics/expose/expose-interactive/>交互式教程 - 暴露你的应用</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tutorials/kubernetes-basics/scale/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">缩放你的应用</a></li><ul><li class=collapse id=zh-docs-tutorials-kubernetes-basics-scale><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-kubernetes-basics-scale-scale-intro href=/zh/docs/tutorials/kubernetes-basics/scale/scale-intro/>运行应用程序的多个实例</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-kubernetes-basics-scale-scale-interactive href=/zh/docs/tutorials/kubernetes-basics/scale/scale-interactive/>交互教程 - 缩放你的应用</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tutorials/kubernetes-basics/update/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">更新你的应用</a></li><ul><li class=collapse id=zh-docs-tutorials-kubernetes-basics-update><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-kubernetes-basics-update-update-intro href=/zh/docs/tutorials/kubernetes-basics/update/update-intro/>执行滚动更新</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-kubernetes-basics-update-update-interactive href=/zh/docs/tutorials/kubernetes-basics/update/update-interactive/>交互式教程 - 更新你的应用</a></li></ul></ul></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tutorials/online-training/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">在线培训课程</a></li><ul><li class=collapse id=zh-docs-tutorials-online-training><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-online-training-overview href=/zh/docs/tutorials/online-training/overview/>Kubernetes 在线培训概述</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tutorials/configuration/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">配置</a></li><ul><li class=collapse id=zh-docs-tutorials-configuration><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-configuration-configure-redis-using-configmap href=/zh/docs/tutorials/configuration/configure-redis-using-configmap/>使用 ConfigMap 来配置 Redis</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tutorials/stateless-application/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">无状态应用程序</a></li><ul><li class=collapse id=zh-docs-tutorials-stateless-application><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-stateless-application-expose-external-ip-address href=/zh/docs/tutorials/stateless-application/expose-external-ip-address/>公开外部 IP 地址以访问集群中应用程序</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-stateless-application-guestbook href=/zh/docs/tutorials/stateless-application/guestbook/>示例：使用 Redis 部署 PHP 留言板应用程序</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-tutorials-stateless-application-guestbook-logs-metrics-with-elk target=_blank href=/docs/tutorials/stateless-application/guestbook-logs-metrics-with-elk/>Example: Add logging and metrics to the PHP / Redis Guestbook example <small>(EN)</small></a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tutorials/stateful-application/ class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">有状态的应用</a></li><ul><li class="collapse show" id=zh-docs-tutorials-stateful-application><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-stateful-application-mysql-wordpress-persistent-volume href=/zh/docs/tutorials/stateful-application/mysql-wordpress-persistent-volume/>示例：使用 Persistent Volumes 部署 WordPress 和 MySQL</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-stateful-application-basic-stateful-set href=/zh/docs/tutorials/stateful-application/basic-stateful-set/>StatefulSet 基础</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-stateful-application-cassandra href=/zh/docs/tutorials/stateful-application/cassandra/>示例：使用 Stateful Sets 部署 Cassandra</a>
<a class="td-sidebar-link td-sidebar-link__page active" id=m-zh-docs-tutorials-stateful-application-zookeeper href=/zh/docs/tutorials/stateful-application/zookeeper/>运行 ZooKeeper， 一个 CP 分布式系统</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tutorials/clusters/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">集群</a></li><ul><li class=collapse id=zh-docs-tutorials-clusters><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-clusters-apparmor href=/zh/docs/tutorials/clusters/apparmor/>AppArmor</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/tutorials/services/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Services</a></li><ul><li class=collapse id=zh-docs-tutorials-services><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-tutorials-services-source-ip href=/zh/docs/tutorials/services/source-ip/>使用 Source IP</a></li></ul></ul></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/reference/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">参考</a></li><ul><li class=collapse id=zh-docs-reference><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-glossary href=/zh/docs/reference/glossary/>标准化词汇表</a><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/reference/issues-security/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Kubernetes 问题和安全</a></li><ul><li class=collapse id=zh-docs-reference-issues-security><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-issues-security-issues href=/zh/docs/reference/issues-security/issues/>Kubernetes 问题追踪</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-issues-security-security href=/zh/docs/reference/issues-security/security/>Kubernetes 安全和信息披露</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/reference/using-api/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">使用 Kubernetes API</a></li><ul><li class=collapse id=zh-docs-reference-using-api><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-using-api-api-overview href=/zh/docs/reference/using-api/api-overview/>Kubernetes API 总览</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-using-api-api-concepts target=_blank href=/docs/reference/using-api/api-concepts/>Kubernetes API Concepts <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-using-api-client-libraries href=/zh/docs/reference/using-api/client-libraries/>客户端库</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-using-api-deprecation-policy target=_blank href=/docs/reference/using-api/deprecation-policy/>Kubernetes Deprecation Policy <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-using-api-health-checks target=_blank href=/docs/reference/using-api/health-checks/>Kubernetes API health endpoints <small>(EN)</small></a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/reference/access-authn-authz/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">访问 API</a></li><ul><li class=collapse id=zh-docs-reference-access-authn-authz><a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-access-authn-authz-authentication target=_blank href=/docs/reference/access-authn-authz/authentication/>Authenticating <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-access-authn-authz-certificate-signing-requests target=_blank href=/docs/reference/access-authn-authz/certificate-signing-requests/>Certificate Signing Requests <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-access-authn-authz-admission-controllers href=/zh/docs/reference/access-authn-authz/admission-controllers/>使用准入控制器</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-access-authn-authz-extensible-admission-controllers href=/zh/docs/reference/access-authn-authz/extensible-admission-controllers/>动态准入控制</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-access-authn-authz-authorization href=/zh/docs/reference/access-authn-authz/authorization/>授权概述</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-access-authn-authz-rbac href=/zh/docs/reference/access-authn-authz/rbac/>使用 RBAC 鉴权</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-access-authn-authz-node href=/zh/docs/reference/access-authn-authz/node/>使用 Node 鉴权</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-access-authn-authz-webhook href=/zh/docs/reference/access-authn-authz/webhook/>Webhook 模式</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-access-authn-authz-controlling-access href=/zh/docs/reference/access-authn-authz/controlling-access/>Kubernetes API 访问控制</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-access-authn-authz-abac href=/zh/docs/reference/access-authn-authz/abac/>使用 ABAC 鉴权</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-access-authn-authz-bootstrap-tokens href=/zh/docs/reference/access-authn-authz/bootstrap-tokens/>使用启动引导令牌（Bootstrap Tokens）认证</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-access-authn-authz-service-accounts-admin href=/zh/docs/reference/access-authn-authz/service-accounts-admin/>管理 Service Accounts</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/reference/kubernetes-api/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">API 参考</a></li><ul><li class=collapse id=zh-docs-reference-kubernetes-api><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-kubernetes-api-api-index href=/zh/docs/reference/kubernetes-api/api-index/>v1.17</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-kubernetes-api-labels-annotations-taints href=/zh/docs/reference/kubernetes-api/labels-annotations-taints/>知名标签（Label）、注解（Annotation）和 Taints</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/reference/setup-tools/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">安装工具</a></li><ul><li class=collapse id=zh-docs-reference-setup-tools><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/reference/setup-tools/kubeadm/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Kubeadm</a></li><ul><li class=collapse id=zh-docs-reference-setup-tools-kubeadm><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/docs/reference/setup-tools/kubeadm/generated/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Kubeadm Generated</a></li><ul><li class=collapse id=docs-reference-setup-tools-kubeadm-generated><a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-certs target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_certs/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-certs-certificate-key target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_certs_certificate-key/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-certs-check-expiration target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_certs_check-expiration/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-certs-renew target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_certs_renew/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-certs-renew-admin-conf target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_certs_renew_admin.conf/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-certs-renew-all target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_certs_renew_all/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-certs-renew-apiserver-etcd-client target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_certs_renew_apiserver-etcd-client/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-certs-renew-apiserver-kubelet-client target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_certs_renew_apiserver-kubelet-client/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-certs-renew-apiserver target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_certs_renew_apiserver/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-certs-renew-controller-manager-conf target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_certs_renew_controller-manager.conf/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-certs-renew-etcd-healthcheck-client target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_certs_renew_etcd-healthcheck-client/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-certs-renew-etcd-peer target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_certs_renew_etcd-peer/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-certs-renew-etcd-server target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_certs_renew_etcd-server/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-certs-renew-front-proxy-client target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_certs_renew_front-proxy-client/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-certs-renew-scheduler-conf target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_certs_renew_scheduler.conf/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-kubeconfig target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_kubeconfig/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-kubeconfig-user target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_kubeconfig_user/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-kubelet target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_kubelet/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-kubelet-config target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_kubelet_config/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-kubelet-config-enable-dynamic target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_kubelet_config_enable-dynamic/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-selfhosting target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_selfhosting/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-alpha-selfhosting-pivot target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_alpha_selfhosting_pivot/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-completion target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_completion/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-config target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_config/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-config-images target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_config_images/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-config-images-list target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_config_images_list/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-config-images-pull target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_config_images_pull/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-config-migrate target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_config_migrate/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-config-print target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_config_print/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-config-print-init-defaults target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_config_print_init-defaults/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-config-print-join-defaults target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_config_print_join-defaults/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-config-view target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_config_view/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-init target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_init/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-init-phase target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_init_phase/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-init-phase-addon target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_init_phase_addon/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-init-phase-addon-all target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_init_phase_addon_all/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-init-phase-addon-coredns target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_init_phase_addon_coredns/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-init-phase-addon-kube-proxy target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_init_phase_addon_kube-proxy/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-init-phase-bootstrap-token target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_init_phase_bootstrap-token/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-init-phase-certs target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_init_phase_certs/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-init-phase-certs-all target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_init_phase_certs_all/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-init-phase-certs-apiserver-etcd-client target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_init_phase_certs_apiserver-etcd-client/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-init-phase-certs-apiserver-kubelet-client target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_init_phase_certs_apiserver-kubelet-client/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-init-phase-certs-apiserver target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_init_phase_certs_apiserver/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-init-phase-certs-ca target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_init_phase_certs_ca/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-init-phase-certs-etcd-ca target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_init_phase_certs_etcd-ca/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-init-phase-certs-etcd-healthcheck-client target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_init_phase_certs_etcd-healthcheck-client/><small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-generated-kubeadm-init-phase-certs-etcd-peer target=_blank href=/docs/reference/setup-tools/kubeadm/generated/kubeadm_init_phase_certs_etcd-peer/><small>(EN)</small></a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-setup-tools-kubeadm-kubeadm href=/zh/docs/reference/setup-tools/kubeadm/kubeadm/>kubeadm 概述</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-setup-tools-kubeadm-kubeadm-init href=/zh/docs/reference/setup-tools/kubeadm/kubeadm-init/>kubeadm init</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-setup-tools-kubeadm-kubeadm-join href=/zh/docs/reference/setup-tools/kubeadm/kubeadm-join/>kubeadm join</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-setup-tools-kubeadm-kubeadm-upgrade href=/zh/docs/reference/setup-tools/kubeadm/kubeadm-upgrade/>kubeadm upgrade</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-setup-tools-kubeadm-kubeadm-config href=/zh/docs/reference/setup-tools/kubeadm/kubeadm-config/>kubeadm config</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-setup-tools-kubeadm-kubeadm-reset href=/zh/docs/reference/setup-tools/kubeadm/kubeadm-reset/>kubeadm reset</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-setup-tools-kubeadm-kubeadm-token href=/zh/docs/reference/setup-tools/kubeadm/kubeadm-token/>kubeadm 令牌</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-setup-tools-kubeadm-kubeadm-version href=/zh/docs/reference/setup-tools/kubeadm/kubeadm-version/>kubeadm version</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-setup-tools-kubeadm-kubeadm-alpha href=/zh/docs/reference/setup-tools/kubeadm/kubeadm-alpha/>kubeadm alpha</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-setup-tools-kubeadm-kubeadm-init-phase href=/zh/docs/reference/setup-tools/kubeadm/kubeadm-init-phase/>kubeadm init phase</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-setup-tools-kubeadm-kubeadm-join-phase href=/zh/docs/reference/setup-tools/kubeadm/kubeadm-join-phase/>kubeadm join phase</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-setup-tools-kubeadm-kubeadm-reset-phase href=/zh/docs/reference/setup-tools/kubeadm/kubeadm-reset-phase/>kubeadm reset phase</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-setup-tools-kubeadm-kubeadm-upgrade-phase href=/zh/docs/reference/setup-tools/kubeadm/kubeadm-upgrade-phase/>kubeadm upgrade phase</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-setup-tools-kubeadm-implementation-details target=_blank href=/docs/reference/setup-tools/kubeadm/implementation-details/>Implementation details <small>(EN)</small></a></li></ul></ul></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/reference/kubectl/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">kubectl 命令行界面</a></li><ul><li class=collapse id=zh-docs-reference-kubectl><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-kubectl-overview href=/zh/docs/reference/kubectl/overview/>kubectl 概述</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-kubectl-jsonpath href=/zh/docs/reference/kubectl/jsonpath/>JSONPath 支持</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-kubectl-kubectl href=/zh/docs/reference/kubectl/kubectl/>kubectl</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-kubectl-kubectl-cmds href=/zh/docs/reference/kubectl/kubectl-cmds/>kubectl 命令</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-kubectl-cheatsheet href=/zh/docs/reference/kubectl/cheatsheet/>kubectl 备忘单</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-kubectl-conventions href=/zh/docs/reference/kubectl/conventions/>kubectl 的用法约定</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-kubectl-docker-cli-to-kubectl href=/zh/docs/reference/kubectl/docker-cli-to-kubectl/>适用于 Docker 用户的 kubectl</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/zh/docs/reference/command-line-tools-reference/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">命令行工具参考</a></li><ul><li class=collapse id=zh-docs-reference-command-line-tools-reference><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-command-line-tools-reference-feature-gates href=/zh/docs/reference/command-line-tools-reference/feature-gates/>特性门控</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-command-line-tools-reference-kube-scheduler href=/zh/docs/reference/command-line-tools-reference/kube-scheduler/>kube-scheduler</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-command-line-tools-reference-kubelet href=/zh/docs/reference/command-line-tools-reference/kubelet/>kubelet</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-command-line-tools-reference-cloud-controller-manager target=_blank href=/docs/reference/command-line-tools-reference/cloud-controller-manager/>cloud-controller-manager <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-command-line-tools-reference-kube-controller-manager href=/zh/docs/reference/command-line-tools-reference/kube-controller-manager/>kube-controller-manager</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-command-line-tools-reference-kube-proxy href=/zh/docs/reference/command-line-tools-reference/kube-proxy/>kube-proxy</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-command-line-tools-reference-kube-apiserver href=/zh/docs/reference/command-line-tools-reference/kube-apiserver/>kube-apiserver</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-command-line-tools-reference-kubelet-authentication-authorization href=/zh/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/>Kubelet authentication/authorization</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-command-line-tools-reference-kubelet-tls-bootstrapping href=/zh/docs/reference/command-line-tools-reference/kubelet-tls-bootstrapping/>TLS bootstrapping</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/docs/reference/scheduling/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Scheduling</a></li><ul><li class=collapse id=docs-reference-scheduling><a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-scheduling-policies target=_blank href=/docs/reference/scheduling/policies/>Scheduling Policies <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-docs-reference-scheduling-profiles target=_blank href=/docs/reference/scheduling/profiles/>Scheduling Profiles <small>(EN)</small></a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-reference-tools href=/zh/docs/reference/tools/>工具</a></li></ul></ul><a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-sitemap href=/zh/docs/sitemap/></a><a class="td-sidebar-link td-sidebar-link__page" id=m-docs-test target=_blank href=/docs/test/>Docs smoke test page <small>(EN)</small></a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-zh-docs-search href=/zh/docs/search/>搜索结果</a></li></ul></ul></nav></div></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=https://kubernetes.io/zh/docs/>文档</a></li><li class=breadcrumb-item><a href=https://kubernetes.io/zh/docs/tutorials/>教程</a></li><li class=breadcrumb-item><a href=https://kubernetes.io/zh/docs/tutorials/stateful-application/>有状态的应用</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://kubernetes.io/zh/docs/tutorials/stateful-application/zookeeper/>运行 ZooKeeper， 一个 CP 分布式系统</a></li></ol></nav><section id=deprecation-warning><div class="content deprecation-warning"><h3>您正在查看 Kubernetes 版本的文档： v1.18</h3><p>Kubernetes v1.18 版本的文档已不再维护。您现在看到的版本来自于一份静态的快照。如需查阅最新文档，请点击
<a href=https://kubernetes.io/docs/home/>最新版本。</a></p></div></section><div class=td-content><p><a href=https://github.com/kubernetes/website/edit/master/content/zh/docs/tutorials/stateful-application/zookeeper.md id=editPageButton target=_blank data-proofer-ignore>Edit This Page</a></p><h1>运行 ZooKeeper， 一个 CP 分布式系统</h1><p>本教程展示了在 Kubernetes 上使用 <a href=/zh/docs/admin/disruptions/#specifying-a-poddisruptionbudget>PodDisruptionBudgets</a> 和 <a href=/zh/docs/user-guide/node-selection/#inter-pod-affinity-and-anti-affinity-beta-feature>PodAntiAffinity</a> 特性运行 <a href=https://zookeeper.apache.org>Apache Zookeeper</a>。</p><h2 id=准备开始>准备开始</h2><p>在开始本教程前，你应该熟悉以下 Kubernetes 概念。</p><ul><li><a href=/zh/docs/user-guide/pods/single-container/>Pods</a></li><li><a href=/zh/docs/concepts/services-networking/dns-pod-service/>Cluster DNS</a></li><li><a href=/zh/docs/concepts/services-networking/service/#headless-services>Headless Services</a></li><li><a href=/zh/docs/concepts/storage/volumes/>PersistentVolumes</a></li><li><a href=http://releases.k8s.io/v1.18.20/examples/persistent-volume-provisioning/>PersistentVolume Provisioning</a></li><li><a href=/zh/docs/tasks/configure-pod-container/configure-pod-configmap/>ConfigMaps</a></li><li><a href=/zh/docs/concepts/abstractions/controllers/statefulsets/>StatefulSets</a></li><li><a href=/zh/docs/admin/disruptions/#specifying-a-poddisruptionbudget>PodDisruptionBudgets</a></li><li><a href=/zh/docs/user-guide/node-selection/#inter-pod-affinity-and-anti-affinity-beta-feature>PodAntiAffinity</a></li><li><a href=/zh/docs/user-guide/kubectl>kubectl CLI</a></li></ul><p>你需要一个至少包含四个节点的集群，每个节点至少 2 CPUs 和 4 GiB 内存。在本教程中你将会 cordon 和 drain 集群的节点。<strong>这意味着集群节点上所有的 Pods 将会被终止并移除</strong>。<strong>这些节点也会暂时变为不可调度</strong>。在本教程中你应该使用一个独占的集群，或者保证你造成的干扰不会影响其它租户。</p><p>本教程假设你的集群配置为动态的提供 PersistentVolumes。如果你的集群没有配置成这样，在开始本教程前，你需要手动准备三个 20 GiB 的卷。</p><h2 id=教程目标>教程目标</h2><p>在学习本教程后，你将熟悉下列内容。</p><ul><li>如何使用 StatefulSet 部署一个 ZooKeeper ensemble。</li><li>如何使用 ConfigMaps 一致性配置 ensemble。</li><li>如何在 ensemble 中 分布 ZooKeeper 服务的部署。</li><li>如何在计划维护中使用 PodDisruptionBudgets 确保服务可用性。</li></ul><h3 id=zookeeper-基础>ZooKeeper 基础</h3><p><a href=https://zookeeper.apache.org/doc/current/>Apache ZooKeeper</a> 是一个分布式的开源协调服务，用于分布式系统。ZooKeeper 允许你读取、写入数据和发现数据更新。数据按层次结构组织在文件系统中，并复制到 ensemble（一个 ZooKeeper 服务的集合） 中所有的 ZooKeeper 服务。对数据的所有操作都是原子的和顺序一致的。ZooKeeper 通过 <a href=https://pdfs.semanticscholar.org/b02c/6b00bd5dbdbd951fddb00b906c82fa80f0b3.pdf>Zab</a> 一致性协议在 ensemble 的所有服务之间复制一个状态机来确保这个特性。</p><p>ensemble 使用 Zab 协议选举一个 leader，在选举出 leader 前不能写入数据。一旦选举出了 leader，ensemble 使用 Zab 保证所有写入被复制到一个 quorum，然后这些写入操作才会被确认并对客户端可用。如果没有遵照加权 quorums，一个 quorum 表示包含当前 leader 的 ensemble 的多数成员。例如，如果 ensemble 有3个服务，一个包含 leader 的成员和另一个服务就组成了一个 quorum。如果 ensemble 不能达成一个 quorum，数据将不能被写入。</p><p>ZooKeeper 在内存中保存它们的整个状态机，但是每个改变都被写入一个在存储介质上的持久 WAL（Write Ahead Log）。当一个服务故障时，它能够通过回放 WAL 恢复之前的状态。为了防止 WAL 无限制的增长，ZooKeeper 服务会定期的将内存状态快照保存到存储介质。这些快照能够直接加载到内存中，所有在这个快照之前的 WAL 条目都可以被安全的丢弃。</p><h2 id=创建一个-zookeeper-ensemble>创建一个 ZooKeeper Ensemble</h2><p>下面的清单包含一个
<a href=/zh/docs/concepts/services-networking/service/#headless-services>Headless Service</a>，
一个 <a href=/zh/docs/concepts/services-networking/service/>Service</a>，
一个 <a href=/zh/docs/concepts/workloads/pods/disruptions//#specifying-a-poddisruptionbudget>PodDisruptionBudget</a>，
和一个 <a href=/zh/docs/concepts/workloads/controllers/statefulset/>StatefulSet</a>。</p><div class=highlight><div class=includecode style=text-align:right id=application-zookeeper-zookeeper-yaml><a href=https://raw.githubusercontent.com/kubernetes/website/master/content/zh/examples/application/zookeeper/zookeeper.yaml download=application/zookeeper/zookeeper.yaml><code>application/zookeeper/zookeeper.yaml</code>
</a><img src=/images/copycode.svg style=max-height:24px;cursor:pointer onclick="copyCode('application-zookeeper-zookeeper-yaml')" title="Copy application/zookeeper/zookeeper.yaml to clipboard"></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#a2f;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>v1<span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#a2f;font-weight:700>kind</span>:<span style=color:#bbb> </span>Service<span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#a2f;font-weight:700>metadata</span>:<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>zk-hs<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>labels</span>:<span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#a2f;font-weight:700>app</span>:<span style=color:#bbb> </span>zk<span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#a2f;font-weight:700>spec</span>:<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>ports</span>:<span style=color:#bbb>
</span><span style=color:#bbb>  </span>- <span style=color:#a2f;font-weight:700>port</span>:<span style=color:#bbb> </span><span style=color:#666>2888</span><span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>server<span style=color:#bbb>
</span><span style=color:#bbb>  </span>- <span style=color:#a2f;font-weight:700>port</span>:<span style=color:#bbb> </span><span style=color:#666>3888</span><span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>leader-election<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>clusterIP</span>:<span style=color:#bbb> </span>None<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>selector</span>:<span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#a2f;font-weight:700>app</span>:<span style=color:#bbb> </span>zk<span style=color:#bbb>
</span><span style=color:#bbb></span>---<span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#a2f;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>v1<span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#a2f;font-weight:700>kind</span>:<span style=color:#bbb> </span>Service<span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#a2f;font-weight:700>metadata</span>:<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>zk-cs<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>labels</span>:<span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#a2f;font-weight:700>app</span>:<span style=color:#bbb> </span>zk<span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#a2f;font-weight:700>spec</span>:<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>ports</span>:<span style=color:#bbb>
</span><span style=color:#bbb>  </span>- <span style=color:#a2f;font-weight:700>port</span>:<span style=color:#bbb> </span><span style=color:#666>2181</span><span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>client<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>selector</span>:<span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#a2f;font-weight:700>app</span>:<span style=color:#bbb> </span>zk<span style=color:#bbb>
</span><span style=color:#bbb></span>---<span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#a2f;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>policy/v1beta1<span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#a2f;font-weight:700>kind</span>:<span style=color:#bbb> </span>PodDisruptionBudget<span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#a2f;font-weight:700>metadata</span>:<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>zk-pdb<span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#a2f;font-weight:700>spec</span>:<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>selector</span>:<span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#a2f;font-weight:700>matchLabels</span>:<span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#a2f;font-weight:700>app</span>:<span style=color:#bbb> </span>zk<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>maxUnavailable</span>:<span style=color:#bbb> </span><span style=color:#666>1</span><span style=color:#bbb>
</span><span style=color:#bbb></span>---<span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#a2f;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>apps/v1<span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#a2f;font-weight:700>kind</span>:<span style=color:#bbb> </span>StatefulSet<span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#a2f;font-weight:700>metadata</span>:<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>zk<span style=color:#bbb>
</span><span style=color:#bbb></span><span style=color:#a2f;font-weight:700>spec</span>:<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>selector</span>:<span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#a2f;font-weight:700>matchLabels</span>:<span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#a2f;font-weight:700>app</span>:<span style=color:#bbb> </span>zk<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>serviceName</span>:<span style=color:#bbb> </span>zk-hs<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>replicas</span>:<span style=color:#bbb> </span><span style=color:#666>3</span><span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>updateStrategy</span>:<span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#a2f;font-weight:700>type</span>:<span style=color:#bbb> </span>RollingUpdate<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>podManagementPolicy</span>:<span style=color:#bbb> </span>OrderedReady<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>template</span>:<span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#a2f;font-weight:700>metadata</span>:<span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#a2f;font-weight:700>labels</span>:<span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#a2f;font-weight:700>app</span>:<span style=color:#bbb> </span>zk<span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#a2f;font-weight:700>spec</span>:<span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#a2f;font-weight:700>affinity</span>:<span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#a2f;font-weight:700>podAntiAffinity</span>:<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span>- <span style=color:#a2f;font-weight:700>labelSelector</span>:<span style=color:#bbb>
</span><span style=color:#bbb>                </span><span style=color:#a2f;font-weight:700>matchExpressions</span>:<span style=color:#bbb>
</span><span style=color:#bbb>                  </span>- <span style=color:#a2f;font-weight:700>key</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;app&#34;</span><span style=color:#bbb>
</span><span style=color:#bbb>                    </span><span style=color:#a2f;font-weight:700>operator</span>:<span style=color:#bbb> </span>In<span style=color:#bbb>
</span><span style=color:#bbb>                    </span><span style=color:#a2f;font-weight:700>values</span>:<span style=color:#bbb>
</span><span style=color:#bbb>                    </span>- zk<span style=color:#bbb>
</span><span style=color:#bbb>              </span><span style=color:#a2f;font-weight:700>topologyKey</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;kubernetes.io/hostname&#34;</span><span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#a2f;font-weight:700>containers</span>:<span style=color:#bbb>
</span><span style=color:#bbb>      </span>- <span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>kubernetes-zookeeper<span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#a2f;font-weight:700>imagePullPolicy</span>:<span style=color:#bbb> </span>Always<span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#a2f;font-weight:700>image</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;k8s.gcr.io/kubernetes-zookeeper:1.0-3.4.10&#34;</span><span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#a2f;font-weight:700>resources</span>:<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>requests</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span><span style=color:#a2f;font-weight:700>memory</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;1Gi&#34;</span><span style=color:#bbb>
</span><span style=color:#bbb>            </span><span style=color:#a2f;font-weight:700>cpu</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;0.5&#34;</span><span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#a2f;font-weight:700>ports</span>:<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- <span style=color:#a2f;font-weight:700>containerPort</span>:<span style=color:#bbb> </span><span style=color:#666>2181</span><span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>client<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- <span style=color:#a2f;font-weight:700>containerPort</span>:<span style=color:#bbb> </span><span style=color:#666>2888</span><span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>server<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- <span style=color:#a2f;font-weight:700>containerPort</span>:<span style=color:#bbb> </span><span style=color:#666>3888</span><span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>leader-election<span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#a2f;font-weight:700>command</span>:<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- sh<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- -c<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- <span style=color:#b44>&#34;start-zookeeper \
</span><span style=color:#b44>          --servers=3 \
</span><span style=color:#b44>          --data_dir=/var/lib/zookeeper/data \
</span><span style=color:#b44>          --data_log_dir=/var/lib/zookeeper/data/log \
</span><span style=color:#b44>          --conf_dir=/opt/zookeeper/conf \
</span><span style=color:#b44>          --client_port=2181 \
</span><span style=color:#b44>          --election_port=3888 \
</span><span style=color:#b44>          --server_port=2888 \
</span><span style=color:#b44>          --tick_time=2000 \
</span><span style=color:#b44>          --init_limit=10 \
</span><span style=color:#b44>          --sync_limit=5 \
</span><span style=color:#b44>          --heap=512M \
</span><span style=color:#b44>          --max_client_cnxns=60 \
</span><span style=color:#b44>          --snap_retain_count=3 \
</span><span style=color:#b44>          --purge_interval=12 \
</span><span style=color:#b44>          --max_session_timeout=40000 \
</span><span style=color:#b44>          --min_session_timeout=4000 \
</span><span style=color:#b44>          --log_level=INFO&#34;</span><span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#a2f;font-weight:700>readinessProbe</span>:<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>exec</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span><span style=color:#a2f;font-weight:700>command</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span>- sh<span style=color:#bbb>
</span><span style=color:#bbb>            </span>- -c<span style=color:#bbb>
</span><span style=color:#bbb>            </span>- <span style=color:#b44>&#34;zookeeper-ready 2181&#34;</span><span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>initialDelaySeconds</span>:<span style=color:#bbb> </span><span style=color:#666>10</span><span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>timeoutSeconds</span>:<span style=color:#bbb> </span><span style=color:#666>5</span><span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#a2f;font-weight:700>livenessProbe</span>:<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>exec</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span><span style=color:#a2f;font-weight:700>command</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span>- sh<span style=color:#bbb>
</span><span style=color:#bbb>            </span>- -c<span style=color:#bbb>
</span><span style=color:#bbb>            </span>- <span style=color:#b44>&#34;zookeeper-ready 2181&#34;</span><span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>initialDelaySeconds</span>:<span style=color:#bbb> </span><span style=color:#666>10</span><span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>timeoutSeconds</span>:<span style=color:#bbb> </span><span style=color:#666>5</span><span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#a2f;font-weight:700>volumeMounts</span>:<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- <span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>datadir<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>mountPath</span>:<span style=color:#bbb> </span>/var/lib/zookeeper<span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#a2f;font-weight:700>securityContext</span>:<span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#a2f;font-weight:700>runAsUser</span>:<span style=color:#bbb> </span><span style=color:#666>1000</span><span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#a2f;font-weight:700>fsGroup</span>:<span style=color:#bbb> </span><span style=color:#666>1000</span><span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>volumeClaimTemplates</span>:<span style=color:#bbb>
</span><span style=color:#bbb>  </span>- <span style=color:#a2f;font-weight:700>metadata</span>:<span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>datadir<span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#a2f;font-weight:700>spec</span>:<span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#a2f;font-weight:700>accessModes</span>:<span style=color:#bbb> </span>[<span style=color:#bbb> </span><span style=color:#b44>&#34;ReadWriteOnce&#34;</span><span style=color:#bbb> </span>]<span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#a2f;font-weight:700>resources</span>:<span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#a2f;font-weight:700>requests</span>:<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>storage</span>:<span style=color:#bbb> </span>10Gi<span style=color:#bbb>
</span></code></pre></div></div><p>打开一个命令行终端，使用 <a href=/zh/docs/reference/generated/kubectl/kubectl-commands/#apply><code>kubectl apply</code></a>
创建这个清单。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl apply -f https://k8s.io/examples/application/zookeeper/zookeeper.yaml
</code></pre></div><p>这个操作创建了 <code>zk-hs</code> Headless Service、<code>zk-cs</code> Service、<code>zk-pdb</code> PodDisruptionBudget 和 <code>zk</code> StatefulSet。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>service/zk-hs created
service/zk-cs created
poddisruptionbudget.policy/zk-pdb created
statefulset.apps/zk created
</code></pre></div><p>使用 <a href=/zh/docs/user-guide/kubectl/v1.18/#get><code>kubectl get</code></a> 查看 StatefulSet 控制器创建的 Pods。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get pods -w -l <span style=color:#b8860b>app</span><span style=color:#666>=</span>zk
</code></pre></div><p>一旦 <code>zk-2</code> Pod 变成 Running 和 Ready 状态，使用 <code>CRTL-C</code> 结束 kubectl。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>NAME      READY     STATUS    RESTARTS   AGE
zk-0      0/1       Pending   <span style=color:#666>0</span>          0s
zk-0      0/1       Pending   <span style=color:#666>0</span>         0s
zk-0      0/1       ContainerCreating   <span style=color:#666>0</span>         0s
zk-0      0/1       Running   <span style=color:#666>0</span>         19s
zk-0      1/1       Running   <span style=color:#666>0</span>         40s
zk-1      0/1       Pending   <span style=color:#666>0</span>         0s
zk-1      0/1       Pending   <span style=color:#666>0</span>         0s
zk-1      0/1       ContainerCreating   <span style=color:#666>0</span>         0s
zk-1      0/1       Running   <span style=color:#666>0</span>         18s
zk-1      1/1       Running   <span style=color:#666>0</span>         40s
zk-2      0/1       Pending   <span style=color:#666>0</span>         0s
zk-2      0/1       Pending   <span style=color:#666>0</span>         0s
zk-2      0/1       ContainerCreating   <span style=color:#666>0</span>         0s
zk-2      0/1       Running   <span style=color:#666>0</span>         19s
zk-2      1/1       Running   <span style=color:#666>0</span>         40s
</code></pre></div><p>StatefulSet 控制器创建了3个 Pods，每个 Pod 包含一个 <a href=http://www-us.apache.org/dist/zookeeper/zookeeper-3.4.9/>ZooKeeper 3.4.9</a> 服务。</p><h3 id=促成-leader-选举>促成 Leader 选举</h3><p>由于在匿名网络中没有用于选举 leader 的终止算法，Zab 要求显式的进行成员关系配置，以执行 leader 选举。Ensemble 中的每个服务都需要具有一个独一无二的标识符，所有的服务均需要知道标识符的全集，并且每个标志都需要和一个网络地址相关联。</p><p>使用 <a href=/zh/docs/user-guide/kubectl/v1.18/#exec><code>kubectl exec</code></a> 获取 <code>zk</code> StatefulSet 中 Pods 的主机名。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#a2f;font-weight:700>for</span> i in <span style=color:#666>0</span> <span style=color:#666>1</span> 2; <span style=color:#a2f;font-weight:700>do</span> kubectl <span style=color:#a2f>exec</span> zk-<span style=color:#b8860b>$i</span> -- hostname; <span style=color:#a2f;font-weight:700>done</span>
</code></pre></div><p>StatefulSet 控制器基于每个 Pod 的序号索引为它们各自提供一个唯一的主机名。主机名采用 <code>&lt;statefulset name>-&lt;ordinal index></code> 的形式。由于 <code>zk</code> StatefulSet 的 <code>replicas</code> 字段设置为3，这个 Set 的控制器将创建3个 Pods，主机名为：<code>zk-0</code>、<code>zk-1</code> 和 <code>zk-2</code>。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>zk-0
zk-1
zk-2
</code></pre></div><p>ZooKeeper ensemble 中的服务使用自然数作为唯一标识符，每个服务的标识符都保存在服务的数据目录中一个名为 <code>myid</code> 的文件里。</p><p>检查每个服务的 <code>myid</code> 文件的内容。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#a2f;font-weight:700>for</span> i in <span style=color:#666>0</span> <span style=color:#666>1</span> 2; <span style=color:#a2f;font-weight:700>do</span> <span style=color:#a2f>echo</span> <span style=color:#b44>&#34;myid zk-</span><span style=color:#b8860b>$i</span><span style=color:#b44>&#34;</span>;kubectl <span style=color:#a2f>exec</span> zk-<span style=color:#b8860b>$i</span> -- cat /var/lib/zookeeper/data/myid; <span style=color:#a2f;font-weight:700>done</span>
</code></pre></div><p>由于标识符为自然数并且序号索引是非负整数，你可以在序号上加 1 来生成一个标识符。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>myid zk-0
<span style=color:#666>1</span>
myid zk-1
<span style=color:#666>2</span>
myid zk-2
<span style=color:#666>3</span>
</code></pre></div><p>获取 <code>zk</code> StatefulSet 中每个 Pod 的 FQDN (Fully Qualified Domain Name，正式域名)。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#a2f;font-weight:700>for</span> i in <span style=color:#666>0</span> <span style=color:#666>1</span> 2; <span style=color:#a2f;font-weight:700>do</span> kubectl <span style=color:#a2f>exec</span> zk-<span style=color:#b8860b>$i</span> -- hostname -f; <span style=color:#a2f;font-weight:700>done</span>
</code></pre></div><p><code>zk-headless</code> Service 为所有 Pods 创建了一个 domain：<code>zk-headless.default.svc.cluster.local</code>。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>zk-0.zk-headless.default.svc.cluster.local
zk-1.zk-headless.default.svc.cluster.local
zk-2.zk-headless.default.svc.cluster.local
</code></pre></div><p><a href=/zh/docs/concepts/services-networking/dns-pod-service/>Kubernetes DNS</a> 中的 A 记录将 FQDNs 解析成为 Pods 的 IP 地址。如果 Pods 被调度，这个 A 记录将会使用 Pods 的新 IP 地址更新，但 A 记录的名称不会改变。</p><p>ZooKeeper 在一个名为 <code>zoo.cfg</code> 的文件中保存它的应用配置。使用 <code>kubectl exec</code> 在 <code>zk-0</code> Pod 中查看 <code>zoo.cfg</code> 文件的内容。</p><pre><code>kubectl exec zk-0 -- cat /opt/zookeeper/conf/zoo.cfg
</code></pre><p>文件底部为 <code>server.1</code>、<code>server.2</code> 和 <code>server.3</code>，其中的 <code>1</code>、<code>2</code>和<code>3</code>分别对应 ZooKeeper 服务的 <code>myid</code> 文件中的标识符。它们被设置为 <code>zk</code> StatefulSet 中的 Pods 的 FQDNs。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#b8860b>clientPort</span><span style=color:#666>=</span><span style=color:#666>2181</span>
<span style=color:#b8860b>dataDir</span><span style=color:#666>=</span>/var/lib/zookeeper/data
<span style=color:#b8860b>dataLogDir</span><span style=color:#666>=</span>/var/lib/zookeeper/log
<span style=color:#b8860b>tickTime</span><span style=color:#666>=</span><span style=color:#666>2000</span>
<span style=color:#b8860b>initLimit</span><span style=color:#666>=</span><span style=color:#666>10</span>
<span style=color:#b8860b>syncLimit</span><span style=color:#666>=</span><span style=color:#666>2000</span>
<span style=color:#b8860b>maxClientCnxns</span><span style=color:#666>=</span><span style=color:#666>60</span>
<span style=color:#b8860b>minSessionTimeout</span><span style=color:#666>=</span> <span style=color:#666>4000</span>
<span style=color:#b8860b>maxSessionTimeout</span><span style=color:#666>=</span> <span style=color:#666>40000</span>
autopurge.snapRetainCount<span style=color:#666>=</span><span style=color:#666>3</span>
autopurge.purgeInterval<span style=color:#666>=</span><span style=color:#666>0</span>
server.1<span style=color:#666>=</span>zk-0.zk-headless.default.svc.cluster.local:2888:3888
server.2<span style=color:#666>=</span>zk-1.zk-headless.default.svc.cluster.local:2888:3888
server.3<span style=color:#666>=</span>zk-2.zk-headless.default.svc.cluster.local:2888:3888
</code></pre></div><h3 id=达成一致>达成一致</h3><p>一致性协议要求每个参与者的标识符唯一。在 Zab 协议里任何两个参与者都不应该声明相同的唯一标识符。对于让系统中的进程协商哪些进程已经提交了哪些数据而言，这是必须的。如果有两个 Pods 使用相同的序号启动，这两个 ZooKeeper 服务会将自己识别为相同的服务。</p><p>当你创建 <code>zk</code> StatefulSet 时，StatefulSet 控制器按照 Pods 的序号索引顺序的创建每个 Pod。在创建下一个 Pod 前会等待每个 Pod 变成 Running 和 Ready 状态。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get pods -w -l <span style=color:#b8860b>app</span><span style=color:#666>=</span>zk
NAME      READY     STATUS    RESTARTS   AGE
zk-0      0/1       Pending   <span style=color:#666>0</span>          0s
zk-0      0/1       Pending   <span style=color:#666>0</span>         0s
zk-0      0/1       ContainerCreating   <span style=color:#666>0</span>         0s
zk-0      0/1       Running   <span style=color:#666>0</span>         19s
zk-0      1/1       Running   <span style=color:#666>0</span>         40s
zk-1      0/1       Pending   <span style=color:#666>0</span>         0s
zk-1      0/1       Pending   <span style=color:#666>0</span>         0s
zk-1      0/1       ContainerCreating   <span style=color:#666>0</span>         0s
zk-1      0/1       Running   <span style=color:#666>0</span>         18s
zk-1      1/1       Running   <span style=color:#666>0</span>         40s
zk-2      0/1       Pending   <span style=color:#666>0</span>         0s
zk-2      0/1       Pending   <span style=color:#666>0</span>         0s
zk-2      0/1       ContainerCreating   <span style=color:#666>0</span>         0s
zk-2      0/1       Running   <span style=color:#666>0</span>         19s
zk-2      1/1       Running   <span style=color:#666>0</span>         40s
</code></pre></div><p>每个 Pod 的 A 记录仅在 Pod 变成 Ready状态时被录入。因此，ZooKeeper 服务的 FQDNs 只会解析到一个 endpoint，而那个 endpoint 将会是一个唯一的 ZooKeeper 服务，这个服务声明了配置在它的 <code>myid</code> 文件中的标识符。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>zk-0.zk-headless.default.svc.cluster.local
zk-1.zk-headless.default.svc.cluster.local
zk-2.zk-headless.default.svc.cluster.local
</code></pre></div><p>这保证了 ZooKeepers 的 <code>zoo.cfg</code> 文件中的 <code>servers</code> 属性代表了一个正确配置的 ensemble。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>server.1<span style=color:#666>=</span>zk-0.zk-headless.default.svc.cluster.local:2888:3888
server.2<span style=color:#666>=</span>zk-1.zk-headless.default.svc.cluster.local:2888:3888
server.3<span style=color:#666>=</span>zk-2.zk-headless.default.svc.cluster.local:2888:3888
</code></pre></div><p>当服务使用 Zab 协议尝试提交一个值的时候，它们会达成一致并成功提交这个值（如果 leader 选举成功并且至少有两个 Pods 处于 Running 和 Ready状态），或者将会失败（如果没有满足上述条件中的任意一条）。当一个服务承认另一个服务的代写时不会有状态产生。</p><h3 id=ensemble-健康检查>Ensemble 健康检查</h3><p>最基本的健康检查是向一个 ZooKeeper 服务写入一些数据，然后从另一个服务读取这些数据。</p><p>使用 <code>zkCli.sh</code> 脚本在 <code>zk-0</code> Pod 上写入 <code>world</code> 到路径 <code>/hello</code>。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl <span style=color:#a2f>exec</span> zk-0 zkCli.sh create /hello world
</code></pre></div><p>这将会把 <code>world</code> 写入 ensemble 的 <code>/hello</code> 路径。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>WATCHER::

WatchedEvent state:SyncConnected type:None path:null
Created /hello
</code></pre></div><p>从 <code>zk-1</code> Pod 获取数据。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl <span style=color:#a2f>exec</span> zk-1 zkCli.sh get /hello
</code></pre></div><p>你在 <code>zk-0</code> 创建的数据在 ensemble 中所有的服务上都是可用的。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>WATCHER::

WatchedEvent state:SyncConnected type:None path:null
world
<span style=color:#b8860b>cZxid</span> <span style=color:#666>=</span> 0x100000002
<span style=color:#b8860b>ctime</span> <span style=color:#666>=</span> Thu Dec <span style=color:#666>08</span> 15:13:30 UTC <span style=color:#666>2016</span>
<span style=color:#b8860b>mZxid</span> <span style=color:#666>=</span> 0x100000002
<span style=color:#b8860b>mtime</span> <span style=color:#666>=</span> Thu Dec <span style=color:#666>08</span> 15:13:30 UTC <span style=color:#666>2016</span>
<span style=color:#b8860b>pZxid</span> <span style=color:#666>=</span> 0x100000002
<span style=color:#b8860b>cversion</span> <span style=color:#666>=</span> <span style=color:#666>0</span>
<span style=color:#b8860b>dataVersion</span> <span style=color:#666>=</span> <span style=color:#666>0</span>
<span style=color:#b8860b>aclVersion</span> <span style=color:#666>=</span> <span style=color:#666>0</span>
<span style=color:#b8860b>ephemeralOwner</span> <span style=color:#666>=</span> 0x0
<span style=color:#b8860b>dataLength</span> <span style=color:#666>=</span> <span style=color:#666>5</span>
<span style=color:#b8860b>numChildren</span> <span style=color:#666>=</span> <span style=color:#666>0</span>
</code></pre></div><h3 id=准备持久存储>准备持久存储</h3><p>如同在 <a href=#zookeeper-basics>ZooKeeper 基础</a> 一节所提到的，ZooKeeper 提交所有的条目到一个持久 WAL，并周期性的将内存快照写入存储介质。对于使用一致性协议实现一个复制状态机的应用来说，使用 WALs 提供持久化是一种常用的技术，对于普通的存储应用也是如此。</p><p>使用 <a href=/zh/docs/user-guide/kubectl/v1.18/#delete><code>kubectl delete</code></a> 删除 <code>zk</code> StatefulSet。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl delete statefulset zk
statefulset <span style=color:#b44>&#34;zk&#34;</span> deleted
</code></pre></div><p>观察 StatefulSet 中的 Pods 变为终止状态。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>get pods -w -l <span style=color:#b8860b>app</span><span style=color:#666>=</span>zk
</code></pre></div><p>当 <code>zk-0</code> 完全终止时，使用 <code>CRTL-C</code> 结束 kubectl。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>zk-2      1/1       Terminating   <span style=color:#666>0</span>         9m
zk-0      1/1       Terminating   <span style=color:#666>0</span>         11m
zk-1      1/1       Terminating   <span style=color:#666>0</span>         10m
zk-2      0/1       Terminating   <span style=color:#666>0</span>         9m
zk-2      0/1       Terminating   <span style=color:#666>0</span>         9m
zk-2      0/1       Terminating   <span style=color:#666>0</span>         9m
zk-1      0/1       Terminating   <span style=color:#666>0</span>         10m
zk-1      0/1       Terminating   <span style=color:#666>0</span>         10m
zk-1      0/1       Terminating   <span style=color:#666>0</span>         10m
zk-0      0/1       Terminating   <span style=color:#666>0</span>         11m
zk-0      0/1       Terminating   <span style=color:#666>0</span>         11m
zk-0      0/1       Terminating   <span style=color:#666>0</span>         11m
</code></pre></div><p>重新应用 <code>zookeeper.yaml</code> 中的代码清单。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl apply -f https://k8s.io/docs/tutorials/stateful-application/zookeeper.yaml
</code></pre></div><p><code>zk</code> StatefulSet 将会被创建。由于清单中的其他 API 对象已经存在，所以它们不会被修改。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>statefulset <span style=color:#b44>&#34;zk&#34;</span> created
Error from server <span style=color:#666>(</span>AlreadyExists<span style=color:#666>)</span>: error when creating <span style=color:#b44>&#34;zookeeper.yaml&#34;</span>: services <span style=color:#b44>&#34;zk-headless&#34;</span> already exists
Error from server <span style=color:#666>(</span>AlreadyExists<span style=color:#666>)</span>: error when creating <span style=color:#b44>&#34;zookeeper.yaml&#34;</span>: configmaps <span style=color:#b44>&#34;zk-config&#34;</span> already exists
Error from server <span style=color:#666>(</span>AlreadyExists<span style=color:#666>)</span>: error when creating <span style=color:#b44>&#34;zookeeper.yaml&#34;</span>: poddisruptionbudgets.policy <span style=color:#b44>&#34;zk-budget&#34;</span> already exists
</code></pre></div><p>观察 StatefulSet 控制器重建 StatefulSet 的 Pods。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get pods -w -l <span style=color:#b8860b>app</span><span style=color:#666>=</span>zk
</code></pre></div><p>一旦 <code>zk-2</code> Pod 处于 Running 和 Ready 状态，使用 <code>CRTL-C</code> 停止 kubectl命令。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>NAME      READY     STATUS    RESTARTS   AGE
zk-0      0/1       Pending   <span style=color:#666>0</span>          0s
zk-0      0/1       Pending   <span style=color:#666>0</span>         0s
zk-0      0/1       ContainerCreating   <span style=color:#666>0</span>         0s
zk-0      0/1       Running   <span style=color:#666>0</span>         19s
zk-0      1/1       Running   <span style=color:#666>0</span>         40s
zk-1      0/1       Pending   <span style=color:#666>0</span>         0s
zk-1      0/1       Pending   <span style=color:#666>0</span>         0s
zk-1      0/1       ContainerCreating   <span style=color:#666>0</span>         0s
zk-1      0/1       Running   <span style=color:#666>0</span>         18s
zk-1      1/1       Running   <span style=color:#666>0</span>         40s
zk-2      0/1       Pending   <span style=color:#666>0</span>         0s
zk-2      0/1       Pending   <span style=color:#666>0</span>         0s
zk-2      0/1       ContainerCreating   <span style=color:#666>0</span>         0s
zk-2      0/1       Running   <span style=color:#666>0</span>         19s
zk-2      1/1       Running   <span style=color:#666>0</span>         40s
</code></pre></div><p>从 <code>zk-2</code> Pod 中获取你在<a href=#sanity-testing-the-ensemble>健康检查</a>中输入的值。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl <span style=color:#a2f>exec</span> zk-2 zkCli.sh get /hello
</code></pre></div><p>尽管 <code>zk</code> StatefulSet 中所有的 Pods 都已经被终止并重建过，ensemble 仍然使用原来的数值提供服务。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>WATCHER::

WatchedEvent state:SyncConnected type:None path:null
world
<span style=color:#b8860b>cZxid</span> <span style=color:#666>=</span> 0x100000002
<span style=color:#b8860b>ctime</span> <span style=color:#666>=</span> Thu Dec <span style=color:#666>08</span> 15:13:30 UTC <span style=color:#666>2016</span>
<span style=color:#b8860b>mZxid</span> <span style=color:#666>=</span> 0x100000002
<span style=color:#b8860b>mtime</span> <span style=color:#666>=</span> Thu Dec <span style=color:#666>08</span> 15:13:30 UTC <span style=color:#666>2016</span>
<span style=color:#b8860b>pZxid</span> <span style=color:#666>=</span> 0x100000002
<span style=color:#b8860b>cversion</span> <span style=color:#666>=</span> <span style=color:#666>0</span>
<span style=color:#b8860b>dataVersion</span> <span style=color:#666>=</span> <span style=color:#666>0</span>
<span style=color:#b8860b>aclVersion</span> <span style=color:#666>=</span> <span style=color:#666>0</span>
<span style=color:#b8860b>ephemeralOwner</span> <span style=color:#666>=</span> 0x0
<span style=color:#b8860b>dataLength</span> <span style=color:#666>=</span> <span style=color:#666>5</span>
<span style=color:#b8860b>numChildren</span> <span style=color:#666>=</span> <span style=color:#666>0</span>
</code></pre></div><p><code>zk</code> StatefulSet 的 <code>spec</code> 中的 <code>volumeClaimTemplates</code> 字段标识了将要为每个 Pod 准备的 PersistentVolume。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#a2f;font-weight:700>volumeClaimTemplates</span>:<span style=color:#bbb>
</span><span style=color:#bbb>  </span>- <span style=color:#a2f;font-weight:700>metadata</span>:<span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>datadir<span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#a2f;font-weight:700>annotations</span>:<span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#a2f;font-weight:700>volume.alpha.kubernetes.io/storage-class</span>:<span style=color:#bbb> </span>anything<span style=color:#bbb>
</span><span style=color:#bbb>    </span><span style=color:#a2f;font-weight:700>spec</span>:<span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#a2f;font-weight:700>accessModes</span>:<span style=color:#bbb> </span>[<span style=color:#bbb> </span><span style=color:#b44>&#34;ReadWriteOnce&#34;</span><span style=color:#bbb> </span>]<span style=color:#bbb>
</span><span style=color:#bbb>      </span><span style=color:#a2f;font-weight:700>resources</span>:<span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#a2f;font-weight:700>requests</span>:<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>storage</span>:<span style=color:#bbb> </span>20Gi<span style=color:#bbb>
</span></code></pre></div><p>StatefulSet 控制器为 StatefulSet 中的每个 Pod 生成一个 PersistentVolumeClaim。</p><p>获取 StatefulSet 的 PersistentVolumeClaims。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get pvc -l <span style=color:#b8860b>app</span><span style=color:#666>=</span>zk
</code></pre></div><p>当 StatefulSet 重新创建它的 Pods时，Pods 的 PersistentVolumes 会被重新挂载。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>NAME           STATUS    VOLUME                                     CAPACITY   ACCESSMODES   AGE
datadir-zk-0   Bound     pvc-bed742cd-bcb1-11e6-994f-42010a800002   20Gi       RWO           1h
datadir-zk-1   Bound     pvc-bedd27d2-bcb1-11e6-994f-42010a800002   20Gi       RWO           1h
datadir-zk-2   Bound     pvc-bee0817e-bcb1-11e6-994f-42010a800002   20Gi       RWO           1h
</code></pre></div><p>StatefulSet 的容器 <code>template</code> 中的 <code>volumeMounts</code> 一节使得 PersistentVolumes 被挂载到 ZooKeeper 服务的数据目录。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>volumeMounts:
        - name: datadir
          mountPath: /var/lib/zookeeper
</code></pre></div><p>当 <code>zk</code> StatefulSet 中的一个 Pod 被（重新）调度时，它总是拥有相同的 PersistentVolume，挂载到 ZooKeeper 服务的数据目录。即使在 Pods 被重新调度时，所有对 ZooKeeper 服务的 WALs 的写入和它们的全部快照都仍然是持久的。</p><h2 id=确保一致性配置>确保一致性配置</h2><p>如同在 <a href=#facilitating-leader-election>促成 leader 选举</a> 和 <a href=#achieving-consensus>达成一致</a> 小节中提到的，ZooKeeper ensemble 中的服务需要一致性的配置来选举一个 leader 并形成一个 quorum。它们还需要 Zab 协议的一致性配置来保证这个协议在网络中正确的工作。你可以使用 ConfigMaps 达到目的。</p><p>获取 <code>zk-config</code> 的 ConfigMap。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell> kubectl get cm zk-config -o yaml
apiVersion: v1
data:
  client.cnxns: <span style=color:#b44>&#34;60&#34;</span>
  ensemble: zk-0;zk-1;zk-2
  init: <span style=color:#b44>&#34;10&#34;</span>
  jvm.heap: 2G
  purge.interval: <span style=color:#b44>&#34;0&#34;</span>
  snap.retain: <span style=color:#b44>&#34;3&#34;</span>
  sync: <span style=color:#b44>&#34;5&#34;</span>
  tick: <span style=color:#b44>&#34;2000&#34;</span>
</code></pre></div><p><code>zk</code> StatefulSet 的 <code>template</code> 中的 <code>env</code> 字段读取 ConfigMap 到环境变量中。这些变量将被注入到容器的运行环境里。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#a2f;font-weight:700>env</span>:<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- <span style=color:#a2f;font-weight:700>name </span>:<span style=color:#bbb> </span>ZK_ENSEMBLE<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>valueFrom</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span><span style=color:#a2f;font-weight:700>configMapKeyRef</span>:<span style=color:#bbb>
</span><span style=color:#bbb>              </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>zk-config<span style=color:#bbb>
</span><span style=color:#bbb>              </span><span style=color:#a2f;font-weight:700>key</span>:<span style=color:#bbb> </span>ensemble<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- <span style=color:#a2f;font-weight:700>name </span>:<span style=color:#bbb> </span>ZK_HEAP_SIZE<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>valueFrom</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span><span style=color:#a2f;font-weight:700>configMapKeyRef</span>:<span style=color:#bbb>
</span><span style=color:#bbb>                </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>zk-config<span style=color:#bbb>
</span><span style=color:#bbb>                </span><span style=color:#a2f;font-weight:700>key</span>:<span style=color:#bbb> </span>jvm.heap<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- <span style=color:#a2f;font-weight:700>name </span>:<span style=color:#bbb> </span>ZK_TICK_TIME<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>valueFrom</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span><span style=color:#a2f;font-weight:700>configMapKeyRef</span>:<span style=color:#bbb>
</span><span style=color:#bbb>                </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>zk-config<span style=color:#bbb>
</span><span style=color:#bbb>                </span><span style=color:#a2f;font-weight:700>key</span>:<span style=color:#bbb> </span>tick<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- <span style=color:#a2f;font-weight:700>name </span>:<span style=color:#bbb> </span>ZK_INIT_LIMIT<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>valueFrom</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span><span style=color:#a2f;font-weight:700>configMapKeyRef</span>:<span style=color:#bbb>
</span><span style=color:#bbb>                </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>zk-config<span style=color:#bbb>
</span><span style=color:#bbb>                </span><span style=color:#a2f;font-weight:700>key</span>:<span style=color:#bbb> </span>init<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- <span style=color:#a2f;font-weight:700>name </span>:<span style=color:#bbb> </span>ZK_SYNC_LIMIT<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>valueFrom</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span><span style=color:#a2f;font-weight:700>configMapKeyRef</span>:<span style=color:#bbb>
</span><span style=color:#bbb>                </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>zk-config<span style=color:#bbb>
</span><span style=color:#bbb>                </span><span style=color:#a2f;font-weight:700>key</span>:<span style=color:#bbb> </span>tick<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- <span style=color:#a2f;font-weight:700>name </span>:<span style=color:#bbb> </span>ZK_MAX_CLIENT_CNXNS<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>valueFrom</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span><span style=color:#a2f;font-weight:700>configMapKeyRef</span>:<span style=color:#bbb>
</span><span style=color:#bbb>                </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>zk-config<span style=color:#bbb>
</span><span style=color:#bbb>                </span><span style=color:#a2f;font-weight:700>key</span>:<span style=color:#bbb> </span>client.cnxns<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- <span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>ZK_SNAP_RETAIN_COUNT<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>valueFrom</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span><span style=color:#a2f;font-weight:700>configMapKeyRef</span>:<span style=color:#bbb>
</span><span style=color:#bbb>                </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>zk-config<span style=color:#bbb>
</span><span style=color:#bbb>                </span><span style=color:#a2f;font-weight:700>key</span>:<span style=color:#bbb> </span>snap.retain<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- <span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>ZK_PURGE_INTERVAL<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>valueFrom</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span><span style=color:#a2f;font-weight:700>configMapKeyRef</span>:<span style=color:#bbb>
</span><span style=color:#bbb>                </span><span style=color:#a2f;font-weight:700>name</span>:<span style=color:#bbb> </span>zk-config<span style=color:#bbb>
</span><span style=color:#bbb>                </span><span style=color:#a2f;font-weight:700>key</span>:<span style=color:#bbb> </span>purge.interval<span style=color:#bbb>
</span></code></pre></div><p>在启动 ZooKeeper 服务进程前，容器的入口点调用了一个 bash 脚本：<code>zkGenConfig.sh</code>。这个 bash 脚本从提供的环境变量中生成了 ZooKeeper 的配置文件。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>command</span>:<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- sh<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- -c<span style=color:#bbb>
</span><span style=color:#bbb>        </span>- zkGenConfig.sh<span style=color:#bbb> </span><span style=color:#080>&amp;&amp;</span><span style=color:#bbb> </span>zkServer.sh<span style=color:#bbb> </span>start-foreground<span style=color:#bbb>
</span></code></pre></div><p>检查 <code>zk</code> StatefulSet 中所有 Pods 的环境变量。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#a2f;font-weight:700>for</span> i in <span style=color:#666>0</span> <span style=color:#666>1</span> 2; <span style=color:#a2f;font-weight:700>do</span> kubectl <span style=color:#a2f>exec</span> zk-<span style=color:#b8860b>$i</span> env | grep ZK_*;echo<span style=color:#b44>&#34;&#34;</span>; <span style=color:#a2f;font-weight:700>done</span>
</code></pre></div><p>所有从 <code>zk-config</code> 取得的参数都包含完全相同的值。这将允许 <code>zkGenConfig.sh</code> 脚本为 ensemble 中所有的 ZooKeeper 服务创建一致性的配置。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#b8860b>ZK_ENSEMBLE</span><span style=color:#666>=</span>zk-0;zk-1;zk-2
<span style=color:#b8860b>ZK_HEAP_SIZE</span><span style=color:#666>=</span>2G
<span style=color:#b8860b>ZK_TICK_TIME</span><span style=color:#666>=</span><span style=color:#666>2000</span>
<span style=color:#b8860b>ZK_INIT_LIMIT</span><span style=color:#666>=</span><span style=color:#666>10</span>
<span style=color:#b8860b>ZK_SYNC_LIMIT</span><span style=color:#666>=</span><span style=color:#666>2000</span>
<span style=color:#b8860b>ZK_MAX_CLIENT_CNXNS</span><span style=color:#666>=</span><span style=color:#666>60</span>
<span style=color:#b8860b>ZK_SNAP_RETAIN_COUNT</span><span style=color:#666>=</span><span style=color:#666>3</span>
<span style=color:#b8860b>ZK_PURGE_INTERVAL</span><span style=color:#666>=</span><span style=color:#666>0</span>
<span style=color:#b8860b>ZK_CLIENT_PORT</span><span style=color:#666>=</span><span style=color:#666>2181</span>
<span style=color:#b8860b>ZK_SERVER_PORT</span><span style=color:#666>=</span><span style=color:#666>2888</span>
<span style=color:#b8860b>ZK_ELECTION_PORT</span><span style=color:#666>=</span><span style=color:#666>3888</span>
<span style=color:#b8860b>ZK_USER</span><span style=color:#666>=</span>zookeeper
<span style=color:#b8860b>ZK_DATA_DIR</span><span style=color:#666>=</span>/var/lib/zookeeper/data
<span style=color:#b8860b>ZK_DATA_LOG_DIR</span><span style=color:#666>=</span>/var/lib/zookeeper/log
<span style=color:#b8860b>ZK_LOG_DIR</span><span style=color:#666>=</span>/var/log/zookeeper

<span style=color:#b8860b>ZK_ENSEMBLE</span><span style=color:#666>=</span>zk-0;zk-1;zk-2
<span style=color:#b8860b>ZK_HEAP_SIZE</span><span style=color:#666>=</span>2G
<span style=color:#b8860b>ZK_TICK_TIME</span><span style=color:#666>=</span><span style=color:#666>2000</span>
<span style=color:#b8860b>ZK_INIT_LIMIT</span><span style=color:#666>=</span><span style=color:#666>10</span>
<span style=color:#b8860b>ZK_SYNC_LIMIT</span><span style=color:#666>=</span><span style=color:#666>2000</span>
<span style=color:#b8860b>ZK_MAX_CLIENT_CNXNS</span><span style=color:#666>=</span><span style=color:#666>60</span>
<span style=color:#b8860b>ZK_SNAP_RETAIN_COUNT</span><span style=color:#666>=</span><span style=color:#666>3</span>
<span style=color:#b8860b>ZK_PURGE_INTERVAL</span><span style=color:#666>=</span><span style=color:#666>0</span>
<span style=color:#b8860b>ZK_CLIENT_PORT</span><span style=color:#666>=</span><span style=color:#666>2181</span>
<span style=color:#b8860b>ZK_SERVER_PORT</span><span style=color:#666>=</span><span style=color:#666>2888</span>
<span style=color:#b8860b>ZK_ELECTION_PORT</span><span style=color:#666>=</span><span style=color:#666>3888</span>
<span style=color:#b8860b>ZK_USER</span><span style=color:#666>=</span>zookeeper
<span style=color:#b8860b>ZK_DATA_DIR</span><span style=color:#666>=</span>/var/lib/zookeeper/data
<span style=color:#b8860b>ZK_DATA_LOG_DIR</span><span style=color:#666>=</span>/var/lib/zookeeper/log
<span style=color:#b8860b>ZK_LOG_DIR</span><span style=color:#666>=</span>/var/log/zookeeper

<span style=color:#b8860b>ZK_ENSEMBLE</span><span style=color:#666>=</span>zk-0;zk-1;zk-2
<span style=color:#b8860b>ZK_HEAP_SIZE</span><span style=color:#666>=</span>2G
<span style=color:#b8860b>ZK_TICK_TIME</span><span style=color:#666>=</span><span style=color:#666>2000</span>
<span style=color:#b8860b>ZK_INIT_LIMIT</span><span style=color:#666>=</span><span style=color:#666>10</span>
<span style=color:#b8860b>ZK_SYNC_LIMIT</span><span style=color:#666>=</span><span style=color:#666>2000</span>
<span style=color:#b8860b>ZK_MAX_CLIENT_CNXNS</span><span style=color:#666>=</span><span style=color:#666>60</span>
<span style=color:#b8860b>ZK_SNAP_RETAIN_COUNT</span><span style=color:#666>=</span><span style=color:#666>3</span>
<span style=color:#b8860b>ZK_PURGE_INTERVAL</span><span style=color:#666>=</span><span style=color:#666>0</span>
<span style=color:#b8860b>ZK_CLIENT_PORT</span><span style=color:#666>=</span><span style=color:#666>2181</span>
<span style=color:#b8860b>ZK_SERVER_PORT</span><span style=color:#666>=</span><span style=color:#666>2888</span>
<span style=color:#b8860b>ZK_ELECTION_PORT</span><span style=color:#666>=</span><span style=color:#666>3888</span>
<span style=color:#b8860b>ZK_USER</span><span style=color:#666>=</span>zookeeper
<span style=color:#b8860b>ZK_DATA_DIR</span><span style=color:#666>=</span>/var/lib/zookeeper/data
<span style=color:#b8860b>ZK_DATA_LOG_DIR</span><span style=color:#666>=</span>/var/lib/zookeeper/log
<span style=color:#b8860b>ZK_LOG_DIR</span><span style=color:#666>=</span>/var/log/zookeeper
</code></pre></div><h3 id=配置日志>配置日志</h3><p><code>zkGenConfig.sh</code> 脚本产生的一个文件控制了 ZooKeeper 的日志行为。ZooKeeper 使用了 <a href=http://logging.apache.org/log4j/2.x/>Log4j</a> 并默认使用基于文件大小和时间的滚动文件追加器作为日志配置。
从 <code>zk</code> StatefulSet 的一个 Pods 中获取日志配置。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl <span style=color:#a2f>exec</span> zk-0 cat /usr/etc/zookeeper/log4j.properties
</code></pre></div><p>下面的日志配置会使 ZooKeeper 进程将其所有的日志写入标志输出文件流中。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>zookeeper.root.logger<span style=color:#666>=</span>CONSOLE
zookeeper.console.threshold<span style=color:#666>=</span>INFO
log4j.rootLogger<span style=color:#666>=</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>zookeeper</span>.root.logger<span style=color:#b68;font-weight:700>}</span>
log4j.appender.CONSOLE<span style=color:#666>=</span>org.apache.log4j.ConsoleAppender
log4j.appender.CONSOLE.Threshold<span style=color:#666>=</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>zookeeper</span>.console.threshold<span style=color:#b68;font-weight:700>}</span>
log4j.appender.CONSOLE.layout<span style=color:#666>=</span>org.apache.log4j.PatternLayout
log4j.appender.CONSOLE.layout.ConversionPattern<span style=color:#666>=</span>%d<span style=color:#666>{</span>ISO8601<span style=color:#666>}</span> <span style=color:#666>[</span>myid:%X<span style=color:#666>{</span>myid<span style=color:#666>}]</span> - %-5p <span style=color:#666>[</span>%t:%C<span style=color:#666>{</span>1<span style=color:#666>}</span>@%L<span style=color:#666>]</span> - %m%n
</code></pre></div><p>这是在容器里安全记录日志的最简单的方法。由于应用的日志被写入标准输出，Kubernetes 将会为你处理日志轮转。Kubernetes 还实现了一个智能保存策略，保证写入标准输出和标准错误流的应用日志不会耗尽本地存储媒介。</p><p>使用 <a href=/zh/docs/user-guide/kubectl/v1.18/#logs><code>kubectl logs</code></a> 从一个 Pod 中取回最后几行日志。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl logs zk-0 --tail <span style=color:#666>20</span>
</code></pre></div><p>使用 <code>kubectl logs</code> 或者从 Kubernetes Dashboard 可以查看写入到标准输出和标准错误流中的应用日志。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>2016-12-06 19:34:16,236 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@827<span style=color:#666>]</span> - Processing ruok <span style=color:#a2f>command</span> from /127.0.0.1:52740
2016-12-06 19:34:16,237 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>Thread-1136:NIOServerCnxn@1008<span style=color:#666>]</span> - Closed socket connection <span style=color:#a2f;font-weight:700>for</span> client /127.0.0.1:52740 <span style=color:#666>(</span>no session established <span style=color:#a2f;font-weight:700>for</span> client<span style=color:#666>)</span>
2016-12-06 19:34:26,155 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxnFactory@192<span style=color:#666>]</span> - Accepted socket connection from /127.0.0.1:52749
2016-12-06 19:34:26,155 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@827<span style=color:#666>]</span> - Processing ruok <span style=color:#a2f>command</span> from /127.0.0.1:52749
2016-12-06 19:34:26,156 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>Thread-1137:NIOServerCnxn@1008<span style=color:#666>]</span> - Closed socket connection <span style=color:#a2f;font-weight:700>for</span> client /127.0.0.1:52749 <span style=color:#666>(</span>no session established <span style=color:#a2f;font-weight:700>for</span> client<span style=color:#666>)</span>
2016-12-06 19:34:26,222 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxnFactory@192<span style=color:#666>]</span> - Accepted socket connection from /127.0.0.1:52750
2016-12-06 19:34:26,222 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@827<span style=color:#666>]</span> - Processing ruok <span style=color:#a2f>command</span> from /127.0.0.1:52750
2016-12-06 19:34:26,226 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>Thread-1138:NIOServerCnxn@1008<span style=color:#666>]</span> - Closed socket connection <span style=color:#a2f;font-weight:700>for</span> client /127.0.0.1:52750 <span style=color:#666>(</span>no session established <span style=color:#a2f;font-weight:700>for</span> client<span style=color:#666>)</span>
2016-12-06 19:34:36,151 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxnFactory@192<span style=color:#666>]</span> - Accepted socket connection from /127.0.0.1:52760
2016-12-06 19:34:36,152 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@827<span style=color:#666>]</span> - Processing ruok <span style=color:#a2f>command</span> from /127.0.0.1:52760
2016-12-06 19:34:36,152 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>Thread-1139:NIOServerCnxn@1008<span style=color:#666>]</span> - Closed socket connection <span style=color:#a2f;font-weight:700>for</span> client /127.0.0.1:52760 <span style=color:#666>(</span>no session established <span style=color:#a2f;font-weight:700>for</span> client<span style=color:#666>)</span>
2016-12-06 19:34:36,230 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxnFactory@192<span style=color:#666>]</span> - Accepted socket connection from /127.0.0.1:52761
2016-12-06 19:34:36,231 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@827<span style=color:#666>]</span> - Processing ruok <span style=color:#a2f>command</span> from /127.0.0.1:52761
2016-12-06 19:34:36,231 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>Thread-1140:NIOServerCnxn@1008<span style=color:#666>]</span> - Closed socket connection <span style=color:#a2f;font-weight:700>for</span> client /127.0.0.1:52761 <span style=color:#666>(</span>no session established <span style=color:#a2f;font-weight:700>for</span> client<span style=color:#666>)</span>
2016-12-06 19:34:46,149 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxnFactory@192<span style=color:#666>]</span> - Accepted socket connection from /127.0.0.1:52767
2016-12-06 19:34:46,149 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@827<span style=color:#666>]</span> - Processing ruok <span style=color:#a2f>command</span> from /127.0.0.1:52767
2016-12-06 19:34:46,149 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>Thread-1141:NIOServerCnxn@1008<span style=color:#666>]</span> - Closed socket connection <span style=color:#a2f;font-weight:700>for</span> client /127.0.0.1:52767 <span style=color:#666>(</span>no session established <span style=color:#a2f;font-weight:700>for</span> client<span style=color:#666>)</span>
2016-12-06 19:34:46,230 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxnFactory@192<span style=color:#666>]</span> - Accepted socket connection from /127.0.0.1:52768
2016-12-06 19:34:46,230 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxn@827<span style=color:#666>]</span> - Processing ruok <span style=color:#a2f>command</span> from /127.0.0.1:52768
2016-12-06 19:34:46,230 <span style=color:#666>[</span>myid:1<span style=color:#666>]</span> - INFO  <span style=color:#666>[</span>Thread-1142:NIOServerCnxn@1008<span style=color:#666>]</span> - Closed socket connection <span style=color:#a2f;font-weight:700>for</span> client /127.0.0.1:52768 <span style=color:#666>(</span>no session established <span style=color:#a2f;font-weight:700>for</span> client<span style=color:#666>)</span>
</code></pre></div><h3 id=配置非特权用户>配置非特权用户</h3><p>在容器中允许应用以特权用户运行这条最佳实践是值得商讨的。如果你的组织要求应用以非特权用户运行，你可以使用 <a href=/zh/docs/tasks/configure-pod-container/security-context/>SecurityContext</a> 控制运行容器入口点的用户。</p><p><code>zk</code> StatefulSet 的 Pod 的 <code>template</code> 包含了一个 SecurityContext。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#a2f;font-weight:700>securityContext</span>:<span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>runAsUser</span>:<span style=color:#bbb> </span><span style=color:#666>1000</span><span style=color:#bbb>
</span><span style=color:#bbb>  </span><span style=color:#a2f;font-weight:700>fsGroup</span>:<span style=color:#bbb> </span><span style=color:#666>1000</span><span style=color:#bbb>
</span></code></pre></div><p>在 Pods 容器内部，UID 1000 对应用户 zookeeper，GID 1000对应用户组 zookeeper。</p><p>从 <code>zk-0</code> Pod 获取 ZooKeeper 进程信息。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl <span style=color:#a2f>exec</span> zk-0 -- ps -elf
</code></pre></div><p>由于 <code>securityContext</code> 对象的 <code>runAsUser</code> 字段被设置为1000而不是 root，ZooKeeper进程将以 zookeeper 用户运行。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>F S UID        PID  PPID  C PRI  NI ADDR SZ WCHAN  STIME TTY          TIME CMD
<span style=color:#666>4</span> S zookeep+     <span style=color:#666>1</span>     <span style=color:#666>0</span>  <span style=color:#666>0</span>  <span style=color:#666>80</span>   <span style=color:#666>0</span> -  <span style=color:#666>1127</span> -      20:46 ?        00:00:00 sh -c zkGenConfig.sh <span style=color:#666>&amp;&amp;</span> zkServer.sh start-foreground
<span style=color:#666>0</span> S zookeep+    <span style=color:#666>27</span>     <span style=color:#666>1</span>  <span style=color:#666>0</span>  <span style=color:#666>80</span>   <span style=color:#666>0</span> - <span style=color:#666>1155556</span> -    20:46 ?        00:00:19 /usr/lib/jvm/java-8-openjdk-amd64/bin/java -Dzookeeper.log.dir<span style=color:#666>=</span>/var/log/zookeeper -Dzookeeper.root.logger<span style=color:#666>=</span>INFO,CONSOLE -cp /usr/bin/../build/classes:/usr/bin/../build/lib/*.jar:/usr/bin/../share/zookeeper/zookeeper-3.4.9.jar:/usr/bin/../share/zookeeper/slf4j-log4j12-1.6.1.jar:/usr/bin/../share/zookeeper/slf4j-api-1.6.1.jar:/usr/bin/../share/zookeeper/netty-3.10.5.Final.jar:/usr/bin/../share/zookeeper/log4j-1.2.16.jar:/usr/bin/../share/zookeeper/jline-0.9.94.jar:/usr/bin/../src/java/lib/*.jar:/usr/bin/../etc/zookeeper: -Xmx2G -Xms2G -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only<span style=color:#666>=</span><span style=color:#a2f>false</span> org.apache.zookeeper.server.quorum.QuorumPeerMain /usr/bin/../etc/zookeeper/zoo.cfg
</code></pre></div><p>默认情况下，当 Pod 的 PersistentVolume 被挂载到 ZooKeeper 服务的数据目录时，它只能被 root 用户访问。这个配置将阻止 ZooKeeper 进程写入它的 WAL 及保存快照。</p><p>在 <code>zk-0</code> Pod 上获取 ZooKeeper 数据目录的文件权限。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl <span style=color:#a2f>exec</span> -ti zk-0 -- ls -ld /var/lib/zookeeper/data
</code></pre></div><p>由于 <code>securityContext</code> 对象的 <code>fsGroup</code> 字段设置为1000，Pods 的 PersistentVolumes 的所有权属于 zookeeper 用户组，因而 ZooKeeper 进程能够成功的读写数据。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>drwxr-sr-x <span style=color:#666>3</span> zookeeper zookeeper <span style=color:#666>4096</span> Dec  <span style=color:#666>5</span> 20:45 /var/lib/zookeeper/data
</code></pre></div><h2 id=管理-zookeeper-进程>管理 ZooKeeper 进程</h2><p><a href=https://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_supervision>ZooKeeper documentation</a> 文档指出“你将需要一个监管程序用于管理每个 ZooKeeper 服务进程（JVM）”。在分布式系统中，使用一个看门狗（监管程序）来重启故障进程是一种常用的模式。</p><h3 id=处理进程故障>处理进程故障</h3><p><a href=/zh/docs/user-guide/pod-states/#restartpolicy>Restart Policies</a> 控制 Kubernetes 如何处理一个 Pod 中容器入口点的进程故障。对于 StatefulSet 中的 Pods 来说，Always 是唯一合适的 RestartPolicy，这也是默认值。你应该<strong>绝不</strong>覆盖 stateful 应用的默认策略。</p><p>检查 <code>zk-0</code> Pod 中运行的 ZooKeeper 服务的进程树。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl <span style=color:#a2f>exec</span> zk-0 -- ps -ef
</code></pre></div><p>作为容器入口点的命令的 PID 为 1，Zookeeper 进程是入口点的子进程，PID 为23。</p><pre><code>UID        PID  PPID  C STIME TTY          TIME CMD
zookeep+     1     0  0 15:03 ?        00:00:00 sh -c zkGenConfig.sh &amp;&amp; zkServer.sh start-foreground
zookeep+    27     1  0 15:03 ?        00:00:03 /usr/lib/jvm/java-8-openjdk-amd64/bin/java -Dzookeeper.log.dir=/var/log/zookeeper -Dzookeeper.root.logger=INFO,CONSOLE -cp /usr/bin/../build/classes:/usr/bin/../build/lib/*.jar:/usr/bin/../share/zookeeper/zookeeper-3.4.9.jar:/usr/bin/../share/zookeeper/slf4j-log4j12-1.6.1.jar:/usr/bin/../share/zookeeper/slf4j-api-1.6.1.jar:/usr/bin/../share/zookeeper/netty-3.10.5.Final.jar:/usr/bin/../share/zookeeper/log4j-1.2.16.jar:/usr/bin/../share/zookeeper/jline-0.9.94.jar:/usr/bin/../src/java/lib/*.jar:/usr/bin/../etc/zookeeper: -Xmx2G -Xms2G -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=false org.apache.zookeeper.server.quorum.QuorumPeerMain /usr/bin/../etc/zookeeper/zoo.cfg
</code></pre><p>在一个终端观察 <code>zk</code> StatefulSet 中的 Pods。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get pod -w -l <span style=color:#b8860b>app</span><span style=color:#666>=</span>zk
</code></pre></div><p>在另一个终端杀掉 Pod <code>zk-0</code> 中的 ZooKeeper 进程。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell> kubectl <span style=color:#a2f>exec</span> zk-0 -- pkill java
</code></pre></div><p>ZooKeeper 进程的终结导致了它父进程的终止。由于容器的 RestartPolicy 是 Always，父进程被重启。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>NAME      READY     STATUS    RESTARTS   AGE
zk-0      1/1       Running   <span style=color:#666>0</span>          21m
zk-1      1/1       Running   <span style=color:#666>0</span>          20m
zk-2      1/1       Running   <span style=color:#666>0</span>          19m
NAME      READY     STATUS    RESTARTS   AGE
zk-0      0/1       Error     <span style=color:#666>0</span>          29m
zk-0      0/1       Running   <span style=color:#666>1</span>         29m
zk-0      1/1       Running   <span style=color:#666>1</span>         29m
</code></pre></div><p>如果你的应用使用一个脚本（例如 zkServer.sh）来启动一个实现了应用业务逻辑的进程，这个脚本必须和子进程一起结束。这保证了当实现应用业务逻辑的进程故障时，Kubernetes 会重启这个应用的容器。</p><p>你的应用配置为自动重启故障进程，但这对于保持一个分布式系统的健康来说是不够的。许多场景下，一个系统进程可以是活动状态但不响应请求，或者是不健康状态。你应该使用 liveness probes 来通知 Kubernetes 你的应用进程处于不健康状态，需要被重启。</p><p><code>zk</code> StatefulSet 的 Pod 的 <code>template</code> 一节指定了一个 liveness probe。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>livenessProbe</span>:<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>exec</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span><span style=color:#a2f;font-weight:700>command</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span>- <span style=color:#b44>&#34;zkOk.sh&#34;</span><span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>initialDelaySeconds</span>:<span style=color:#bbb> </span><span style=color:#666>15</span><span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>timeoutSeconds</span>:<span style=color:#bbb> </span><span style=color:#666>5</span><span style=color:#bbb>
</span></code></pre></div><p>这个探针调用一个简单的 bash 脚本，使用 ZooKeeper 的四字缩写 <code>ruok</code> 来测试服务的健康状态。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#b8860b>ZK_CLIENT_PORT</span><span style=color:#666>=</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>ZK_CLIENT_PORT</span><span style=color:#a2f;font-weight:700>:-</span><span style=color:#b8860b>2181</span><span style=color:#b68;font-weight:700>}</span>
<span style=color:#b8860b>OK</span><span style=color:#666>=</span><span style=color:#a2f;font-weight:700>$(</span><span style=color:#a2f>echo</span> ruok | nc 127.0.0.1 <span style=color:#b8860b>$ZK_CLIENT_PORT</span><span style=color:#a2f;font-weight:700>)</span>
<span style=color:#a2f;font-weight:700>if</span> <span style=color:#666>[</span> <span style=color:#b44>&#34;</span><span style=color:#b8860b>$OK</span><span style=color:#b44>&#34;</span> <span style=color:#666>==</span> <span style=color:#b44>&#34;imok&#34;</span> <span style=color:#666>]</span>; <span style=color:#a2f;font-weight:700>then</span>
    <span style=color:#a2f>exit</span> <span style=color:#666>0</span>
<span style=color:#a2f;font-weight:700>else</span>
    <span style=color:#a2f>exit</span> <span style=color:#666>1</span>
<span style=color:#a2f;font-weight:700>fi</span>
</code></pre></div><p>在一个终端窗口观察 <code>zk</code> StatefulSet 中的 Pods。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get pod -w -l <span style=color:#b8860b>app</span><span style=color:#666>=</span>zk
</code></pre></div><p>在另一个窗口中，从 Pod <code>zk-0</code> 的文件系统中删除 <code>zkOk.sh</code> 脚本。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl <span style=color:#a2f>exec</span> zk-0 -- rm /opt/zookeeper/bin/zkOk.sh
</code></pre></div><p>当 ZooKeeper 进程的 liveness probe 失败时，Kubernetes 将会为你自动重启这个进程，从而保证 ensemble 中不健康状态的进程都被重启。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get pod -w -l <span style=color:#b8860b>app</span><span style=color:#666>=</span>zk
NAME      READY     STATUS    RESTARTS   AGE
zk-0      1/1       Running   <span style=color:#666>0</span>          1h
zk-1      1/1       Running   <span style=color:#666>0</span>          1h
zk-2      1/1       Running   <span style=color:#666>0</span>          1h
NAME      READY     STATUS    RESTARTS   AGE
zk-0      0/1       Running   <span style=color:#666>0</span>          1h
zk-0      0/1       Running   <span style=color:#666>1</span>         1h
zk-0      1/1       Running   <span style=color:#666>1</span>         1h
</code></pre></div><h3 id=可读性测试>可读性测试</h3><p>可读性不同于存活性。如果一个进程是存活的，它是可调度和健康的。如果一个进程是就绪的，它应该能够处理输入。存活性是可读性的必要非充分条件。在许多场景下，特别是初始化和终止过程中，一个进程可以是存活但没有就绪。</p><p>如果你指定了一个可读性探针，Kubernetes将保证在可读性检查通过之前，你的应用不会接收到网络流量。</p><p>对于一个 ZooKeeper 服务来说，存活性实现了可读性。因此 <code>zookeeper.yaml</code> 清单中的可读性探针和存活性探针完全相同。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>readinessProbe</span>:<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>exec</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span><span style=color:#a2f;font-weight:700>command</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span>- <span style=color:#b44>&#34;zkOk.sh&#34;</span><span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>initialDelaySeconds</span>:<span style=color:#bbb> </span><span style=color:#666>15</span><span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>timeoutSeconds</span>:<span style=color:#bbb> </span><span style=color:#666>5</span><span style=color:#bbb>
</span></code></pre></div><p>虽然存活性探针和可读性探针是相同的，但同时指定它们两者仍然重要。这保证了 ZooKeeper ensemble 中唯一健康的服务能够接收网络流量。</p><h2 id=容忍节点故障>容忍节点故障</h2><p>ZooKeeper 需要一个服务的 quorum 来成功的提交数据变动。对于一个 3 个服务的 ensemble，必须有两个是健康的写入才能成功。在基于 quorum 的系统里，成员被部署在故障域之间以保证可用性。为了防止由于某台机器断连引起服务中断，最佳实践是防止应用的多个示例在相同的机器上共存。</p><p>默认情况下，Kubernetes 可以把 StatefulSet 的 Pods 部署在相同节点上。对于你创建的 3 个服务的 ensemble 来说，如果有两个服务并存于相同的节点上并且该节点发生故障时，你的 ZooKeeper 服务客户端将不能使用服务，至少一个 Pods 被重新调度后才能恢复。</p><p>你应该总是提供额外的容量以允许关键系统进程在节点故障时能够被重新调度。如果你这样做了，服务故障就只会持续到 Kubernetes 调度器重新调度 ZooKeeper 服务之前。但是，如果希望你的服务在容忍节点故障时无停服时间，你应该设置 <code>podAntiAffinity</code>。</p><p>获取 <code>zk</code> Stateful Set 中的 Pods 的节点。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#a2f;font-weight:700>for</span> i in <span style=color:#666>0</span> <span style=color:#666>1</span> 2; <span style=color:#a2f;font-weight:700>do</span> kubectl get pod zk-<span style=color:#b8860b>$i</span> --template <span style=color:#666>{{</span>.spec.nodeName<span style=color:#666>}}</span>; <span style=color:#a2f>echo</span> <span style=color:#b44>&#34;&#34;</span>; <span style=color:#a2f;font-weight:700>done</span>
</code></pre></div><p><code>zk</code> StatefulSe 中所有的 Pods 都被部署在不同的节点。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubernetes-minion-group-cxpk
kubernetes-minion-group-a5aq
kubernetes-minion-group-2g2d
</code></pre></div><p>这是因为 <code>zk</code> StatefulSet 中的 Pods 指定了 PodAntiAffinity。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#bbb>      </span><span style=color:#a2f;font-weight:700>affinity</span>:<span style=color:#bbb>
</span><span style=color:#bbb>        </span><span style=color:#a2f;font-weight:700>podAntiAffinity</span>:<span style=color:#bbb>
</span><span style=color:#bbb>          </span><span style=color:#a2f;font-weight:700>requiredDuringSchedulingIgnoredDuringExecution</span>:<span style=color:#bbb>
</span><span style=color:#bbb>            </span>- <span style=color:#a2f;font-weight:700>labelSelector</span>:<span style=color:#bbb>
</span><span style=color:#bbb>                </span><span style=color:#a2f;font-weight:700>matchExpressions</span>:<span style=color:#bbb>
</span><span style=color:#bbb>                  </span>- <span style=color:#a2f;font-weight:700>key</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;app&#34;</span><span style=color:#bbb>
</span><span style=color:#bbb>                    </span><span style=color:#a2f;font-weight:700>operator</span>:<span style=color:#bbb> </span>In<span style=color:#bbb>
</span><span style=color:#bbb>                    </span><span style=color:#a2f;font-weight:700>values</span>:<span style=color:#bbb>
</span><span style=color:#bbb>                    </span>- zk<span style=color:#bbb>
</span><span style=color:#bbb>              </span><span style=color:#a2f;font-weight:700>topologyKey</span>:<span style=color:#bbb> </span><span style=color:#b44>&#34;kubernetes.io/hostname&#34;</span><span style=color:#bbb>
</span></code></pre></div><p><code>requiredDuringSchedulingRequiredDuringExecution</code> 告诉 Kubernetes 调度器，在以 <code>topologyKey</code> 指定的域中，绝对不要把带有键为 <code>app</code>，值为 <code>zk</code> 的标签的两个 Pods 调度到相同的节点。<code>topologyKey</code>
<code>kubernetes.io/hostname</code> 表示这个域是一个单独的节点。使用不同的 rules、labels 和 selectors，你能够通过这种技术把你的 ensemble 在物理、网络和电力故障域之间分布。</p><h2 id=存活管理>存活管理</h2><p><strong>在本节中你将会 cordon 和 drain 节点。如果你是在一个共享的集群里使用本教程，请保证不会影响到其他租户</strong></p><p>上一小节展示了如何在节点之间分散 Pods 以在计划外的节点故障时存活。但是你也需要为计划内维护引起的临时节点故障做准备。</p><p>获取你集群中的节点。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get nodes
</code></pre></div><p>使用 <a href=/zh/docs/user-guide/kubectl/v1.18/#cordon><code>kubectl cordon</code></a> cordon 你的集群中除4个节点以外的所有节点。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl cordon &lt; node name &gt;
</code></pre></div><p>获取 <code>zk-budget</code> PodDisruptionBudget。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get poddisruptionbudget zk-budget
</code></pre></div><p><code>min-available</code> 字段指示 Kubernetes 在任何时候，<code>zk</code> StatefulSet 至少有两个 Pods 必须是可用的。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>NAME<span style=color:#bbb>        </span>MIN-AVAILABLE<span style=color:#bbb>   </span>ALLOWED-DISRUPTIONS<span style=color:#bbb>   </span>AGE<span style=color:#bbb>
</span><span style=color:#bbb></span>zk-budget<span style=color:#bbb>   </span><span style=color:#666>2</span><span style=color:#bbb>               </span><span style=color:#666>1</span><span style=color:#bbb>                     </span>1h<span style=color:#bbb>
</span><span style=color:#bbb>
</span></code></pre></div><p>在一个终端观察 <code>zk</code> StatefulSet 中的 Pods。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get pods -w -l <span style=color:#b8860b>app</span><span style=color:#666>=</span>zk
</code></pre></div><p>在另一个终端获取 Pods 当前调度的节点。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#a2f;font-weight:700>for</span> i in <span style=color:#666>0</span> <span style=color:#666>1</span> 2; <span style=color:#a2f;font-weight:700>do</span> kubectl get pod zk-<span style=color:#b8860b>$i</span> --template <span style=color:#666>{{</span>.spec.nodeName<span style=color:#666>}}</span>; <span style=color:#a2f>echo</span> <span style=color:#b44>&#34;&#34;</span>; <span style=color:#a2f;font-weight:700>done</span>
kubernetes-minion-group-pb41
kubernetes-minion-group-ixsl
kubernetes-minion-group-i4c4

</code></pre></div><p>使用 <a href=/zh/docs/user-guide/kubectl/v1.18/#drain><code>kubectl drain</code></a> 来 cordon 和 drain <code>zk-0</code> Pod 调度的节点。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl drain <span style=color:#a2f;font-weight:700>$(</span>kubectl get pod zk-0 --template <span style=color:#666>{{</span>.spec.nodeName<span style=color:#666>}}</span><span style=color:#a2f;font-weight:700>)</span> --ignore-daemonsets --force --delete-local-data
node <span style=color:#b44>&#34;kubernetes-minion-group-pb41&#34;</span> cordoned
WARNING: Deleting pods not managed by ReplicationController, ReplicaSet, Job, or DaemonSet: fluentd-cloud-logging-kubernetes-minion-group-pb41, kube-proxy-kubernetes-minion-group-pb41; Ignoring DaemonSet-managed pods: node-problem-detector-v0.1-o5elz
pod <span style=color:#b44>&#34;zk-0&#34;</span> deleted
node <span style=color:#b44>&#34;kubernetes-minion-group-pb41&#34;</span> drained

</code></pre></div><p>由于你的集群中有4个节点, <code>kubectl drain</code> 执行成功，`zk-0 被调度到其它节点。</p><pre><code>NAME      READY     STATUS    RESTARTS   AGE
zk-0      1/1       Running   2          1h
zk-1      1/1       Running   0          1h
zk-2      1/1       Running   0          1h
NAME      READY     STATUS        RESTARTS   AGE
zk-0      1/1       Terminating   2          2h
zk-0      0/1       Terminating   2         2h
zk-0      0/1       Terminating   2         2h
zk-0      0/1       Terminating   2         2h
zk-0      0/1       Pending   0         0s
zk-0      0/1       Pending   0         0s
zk-0      0/1       ContainerCreating   0         0s
zk-0      0/1       Running   0         51s
zk-0      1/1       Running   0         1m
</code></pre><p>在第一个终端持续观察 StatefulSet 的 Pods并 drain <code>zk-1</code> 调度的节点。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl drain <span style=color:#a2f;font-weight:700>$(</span>kubectl get pod zk-1 --template <span style=color:#666>{{</span>.spec.nodeName<span style=color:#666>}}</span><span style=color:#a2f;font-weight:700>)</span> --ignore-daemonsets --force --delete-local-data <span style=color:#b44>&#34;kubernetes-minion-group-ixsl&#34;</span> cordoned
WARNING: Deleting pods not managed by ReplicationController, ReplicaSet, Job, or DaemonSet: fluentd-cloud-logging-kubernetes-minion-group-ixsl, kube-proxy-kubernetes-minion-group-ixsl; Ignoring DaemonSet-managed pods: node-problem-detector-v0.1-voc74
pod <span style=color:#b44>&#34;zk-1&#34;</span> deleted
node <span style=color:#b44>&#34;kubernetes-minion-group-ixsl&#34;</span> drained

</code></pre></div><p><code>zk-1</code> Pod 不能被调度。由于 <code>zk</code> StatefulSet 包含了一个防止 Pods 共存的 PodAntiAffinity 规则，而且只有两个节点可用于调度，这个 Pod 将保持在 Pending 状态。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get pods -w -l <span style=color:#b8860b>app</span><span style=color:#666>=</span>zk
NAME      READY     STATUS    RESTARTS   AGE
zk-0      1/1       Running   <span style=color:#666>2</span>          1h
zk-1      1/1       Running   <span style=color:#666>0</span>          1h
zk-2      1/1       Running   <span style=color:#666>0</span>          1h
NAME      READY     STATUS        RESTARTS   AGE
zk-0      1/1       Terminating   <span style=color:#666>2</span>          2h
zk-0      0/1       Terminating   <span style=color:#666>2</span>         2h
zk-0      0/1       Terminating   <span style=color:#666>2</span>         2h
zk-0      0/1       Terminating   <span style=color:#666>2</span>         2h
zk-0      0/1       Pending   <span style=color:#666>0</span>         0s
zk-0      0/1       Pending   <span style=color:#666>0</span>         0s
zk-0      0/1       ContainerCreating   <span style=color:#666>0</span>         0s
zk-0      0/1       Running   <span style=color:#666>0</span>         51s
zk-0      1/1       Running   <span style=color:#666>0</span>         1m
zk-1      1/1       Terminating   <span style=color:#666>0</span>         2h
zk-1      0/1       Terminating   <span style=color:#666>0</span>         2h
zk-1      0/1       Terminating   <span style=color:#666>0</span>         2h
zk-1      0/1       Terminating   <span style=color:#666>0</span>         2h
zk-1      0/1       Pending   <span style=color:#666>0</span>         0s
zk-1      0/1       Pending   <span style=color:#666>0</span>         0s
</code></pre></div><p>继续观察 stateful set 的 Pods 并 drain <code>zk-2</code> 调度的节点。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl drain <span style=color:#a2f;font-weight:700>$(</span>kubectl get pod zk-2 --template <span style=color:#666>{{</span>.spec.nodeName<span style=color:#666>}}</span><span style=color:#a2f;font-weight:700>)</span> --ignore-daemonsets --force --delete-local-data
node <span style=color:#b44>&#34;kubernetes-minion-group-i4c4&#34;</span> cordoned
WARNING: Deleting pods not managed by ReplicationController, ReplicaSet, Job, or DaemonSet: fluentd-cloud-logging-kubernetes-minion-group-i4c4, kube-proxy-kubernetes-minion-group-i4c4; Ignoring DaemonSet-managed pods: node-problem-detector-v0.1-dyrog
WARNING: Ignoring DaemonSet-managed pods: node-problem-detector-v0.1-dyrog; Deleting pods not managed by ReplicationController, ReplicaSet, Job, or DaemonSet: fluentd-cloud-logging-kubernetes-minion-group-i4c4, kube-proxy-kubernetes-minion-group-i4c4
There are pending pods when an error occurred: Cannot evict pod as it would violate the pod<span>&#39;</span>s disruption budget.
pod/zk-2

</code></pre></div><p>使用 <code>CRTL-C</code> 终止 kubectl。</p><p>你不能 drain 第三个节点，因为删除 <code>zk-2</code> 将和 <code>zk-budget</code> 冲突。然而这个节点仍然保持 cordoned。</p><p>使用 <code>zkCli.sh</code> 从 <code>zk-0</code> 取回你的健康检查中输入的数值。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl <span style=color:#a2f>exec</span> zk-0 zkCli.sh get /hello
</code></pre></div><p>由于遵守了 PodDisruptionBudget，服务仍然可用。</p><pre><code>WatchedEvent state:SyncConnected type:None path:null
world
cZxid = 0x200000002
ctime = Wed Dec 07 00:08:59 UTC 2016
mZxid = 0x200000002
mtime = Wed Dec 07 00:08:59 UTC 2016
pZxid = 0x200000002
cversion = 0
dataVersion = 0
aclVersion = 0
ephemeralOwner = 0x0
dataLength = 5
numChildren = 0
</code></pre><p>使用 <a href=/zh/docs/user-guide/kubectl/v1.18/#uncordon><code>kubectl uncordon</code></a> 来取消对第一个节点的隔离。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl uncordon kubernetes-minion-group-pb41
node <span style=color:#b44>&#34;kubernetes-minion-group-pb41&#34;</span> uncordoned
</code></pre></div><p><code>zk-1</code> 被重新调度到了这个节点。等待 <code>zk-1</code> 变为 Running 和 Ready 状态。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get pods -w -l <span style=color:#b8860b>app</span><span style=color:#666>=</span>zk
NAME      READY     STATUS    RESTARTS   AGE
zk-0      1/1       Running   <span style=color:#666>2</span>          1h
zk-1      1/1       Running   <span style=color:#666>0</span>          1h
zk-2      1/1       Running   <span style=color:#666>0</span>          1h
NAME      READY     STATUS        RESTARTS   AGE
zk-0      1/1       Terminating   <span style=color:#666>2</span>          2h
zk-0      0/1       Terminating   <span style=color:#666>2</span>         2h
zk-0      0/1       Terminating   <span style=color:#666>2</span>         2h
zk-0      0/1       Terminating   <span style=color:#666>2</span>         2h
zk-0      0/1       Pending   <span style=color:#666>0</span>         0s
zk-0      0/1       Pending   <span style=color:#666>0</span>         0s
zk-0      0/1       ContainerCreating   <span style=color:#666>0</span>         0s
zk-0      0/1       Running   <span style=color:#666>0</span>         51s
zk-0      1/1       Running   <span style=color:#666>0</span>         1m
zk-1      1/1       Terminating   <span style=color:#666>0</span>         2h
zk-1      0/1       Terminating   <span style=color:#666>0</span>         2h
zk-1      0/1       Terminating   <span style=color:#666>0</span>         2h
zk-1      0/1       Terminating   <span style=color:#666>0</span>         2h
zk-1      0/1       Pending   <span style=color:#666>0</span>         0s
zk-1      0/1       Pending   <span style=color:#666>0</span>         0s
zk-1      0/1       Pending   <span style=color:#666>0</span>         12m
zk-1      0/1       ContainerCreating   <span style=color:#666>0</span>         12m
zk-1      0/1       Running   <span style=color:#666>0</span>         13m
zk-1      1/1       Running   <span style=color:#666>0</span>         13m
</code></pre></div><p>尝试 drain <code>zk-2</code> 调度的节点。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl drain <span style=color:#a2f;font-weight:700>$(</span>kubectl get pod zk-2 --template <span style=color:#666>{{</span>.spec.nodeName<span style=color:#666>}}</span><span style=color:#a2f;font-weight:700>)</span> --ignore-daemonsets --force --delete-local-data
node <span style=color:#b44>&#34;kubernetes-minion-group-i4c4&#34;</span> already cordoned
WARNING: Deleting pods not managed by ReplicationController, ReplicaSet, Job, or DaemonSet: fluentd-cloud-logging-kubernetes-minion-group-i4c4, kube-proxy-kubernetes-minion-group-i4c4; Ignoring DaemonSet-managed pods: node-problem-detector-v0.1-dyrog
pod <span style=color:#b44>&#34;heapster-v1.2.0-2604621511-wht1r&#34;</span> deleted
pod <span style=color:#b44>&#34;zk-2&#34;</span> deleted
node <span style=color:#b44>&#34;kubernetes-minion-group-i4c4&#34;</span> drained

</code></pre></div><p>这次 <code>kubectl drain</code> 执行成功。</p><p>Uncordon 第二个节点以允许 <code>zk-2</code> 被重新调度。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl uncordon kubernetes-minion-group-ixsl
node <span style=color:#b44>&#34;kubernetes-minion-group-ixsl&#34;</span> uncordoned
</code></pre></div><p>你可以同时使用 <code>kubectl drain</code> 和 PodDisruptionBudgets 来保证你的服务在维护过程中仍然可用。如果使用 drain 来隔离节点并在此之前删除 pods 使节点进入离线维护状态，如果服务表达了 disruption budget，这个 budget 将被遵守。你应该总是为关键服务分配额外容量，这样它们的 Pods 就能够迅速的重新调度。</p><h2 id=清理现场>清理现场</h2><ul><li>使用 <code>kubectl uncordon</code> 解除你集群中所有节点的隔离。</li><li>你需要删除在本教程中使用的 PersistentVolumes 的持久存储媒介。请遵循必须的步骤，基于你的环境、存储配置和准备方法，保证回收所有的存储。</li></ul><div id=pre-footer><h2>反馈</h2><p class=feedback--prompt>此页是否对您有帮助？</p><button class="btn btn-primary mb-4 feedback--yes">是</button>
<button class="btn btn-primary mb-4 feedback--no">否</button><p class="feedback--response feedback--response__hidden">感谢反馈。如果您有一个关于如何使用 Kubernetes 的特定的、需要答案的问题，可以访问
<a target=_blank rel=noopener href=https://stackoverflow.com/questions/tagged/kubernetes>Stack Overflow</a>.
在 GitHub 仓库上登记新的问题
<a class=feedback--link target=_blank rel=noopener href="https://github.com/kubernetes/website/issues/new?title=Issue%20with%20k8s.io">报告问题</a>
或者
<a class=feedback--link target=_blank rel=noopener href="https://github.com/kubernetes/website/issues/new?title=Improvement%20for%20k8s.io">提出改进建议</a>.</p></div><script>const yes=document.querySelector('.feedback--yes');const no=document.querySelector('.feedback--no');document.querySelectorAll('.feedback--link').forEach(link=>{link.href=link.href+window.location.pathname;});const sendFeedback=(value)=>{if(!gtag){console.log('!gtag');}
gtag('event','click',{'event_category':'Helpful','event_label':window.location.pathname,value});};const disableButtons=()=>{yes.disabled=true;yes.classList.add('feedback--button__disabled');no.disabled=true;no.classList.add('feedback--button__disabled');};yes.addEventListener('click',()=>{sendFeedback(1);disableButtons();document.querySelector('.feedback--response').classList.remove('feedback--response__hidden');});no.addEventListener('click',()=>{sendFeedback(0);disableButtons();document.querySelector('.feedback--response').classList.remove('feedback--response__hidden');});</script><div id=pre-footer><hr><div class=issue-button-container><script type=text/javascript>PDRTJS_settings_8345992={"id":"8345992","unique_id":"\/zh\/docs\/tutorials\/stateful-application\/zookeeper\/","title":"运行 ZooKeeper， 一个 CP 分布式系统","permalink":"https:\/\/kubernetes.io\/zh\/docs\/tutorials\/stateful-application\/zookeeper\/"};(function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=("https:"==document.location.protocol)?"https://polldaddy.com/js/rating/rating.js":"http://i0.poll.fm/js/rating/rating.js";s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,"script","pd-rating-js"));</script><a class="btn btn-primary mb-4 issue" href onclick="window.open('https://github.com/kubernetes/website/issues/new?template=bug-report.md&title=Issue%20with%20'+
'k8s.io'+window.location.pathname)">报告 GitHub 问题</a>
<a class="btn btn-primary mb-4 issue" href=https://github.com/kubernetes/website/edit/master/content/zh/docs/tutorials/stateful-application/zookeeper.md>修改本页面</a></div><div class="lastedit issue-button-container" id=lastedit>页面最后一次修改于
June 01, 2020 at 9:23 AM PST
由：
<a href=https://github.com/kubernetes/website/commit/4b35d4d401e6f637815d3421fabe0dc0dc0917c3/>add zh pages</a>
(<a href=https://github.com/kubernetes/website/commits/master/content/en/docs/tutorials/stateful-application/zookeeper.md>页面历史</a>)</div></div></main><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"><nav id=TableOfContents><ul><li><a href=#准备开始>准备开始</a></li><li><a href=#教程目标>教程目标</a><ul><li><a href=#zookeeper-基础>ZooKeeper 基础</a></li></ul></li><li><a href=#创建一个-zookeeper-ensemble>创建一个 ZooKeeper Ensemble</a><ul><li><a href=#促成-leader-选举>促成 Leader 选举</a></li><li><a href=#达成一致>达成一致</a></li><li><a href=#ensemble-健康检查>Ensemble 健康检查</a></li><li><a href=#准备持久存储>准备持久存储</a></li></ul></li><li><a href=#确保一致性配置>确保一致性配置</a><ul><li><a href=#配置日志>配置日志</a></li><li><a href=#配置非特权用户>配置非特权用户</a></li></ul></li><li><a href=#管理-zookeeper-进程>管理 ZooKeeper 进程</a><ul><li><a href=#处理进程故障>处理进程故障</a></li><li><a href=#可读性测试>可读性测试</a></li></ul></li><li><a href=#容忍节点故障>容忍节点故障</a></li><li><a href=#存活管理>存活管理</a></li><li><a href=#清理现场>清理现场</a></li></ul></nav></div></div></div><footer class=d-print-none><div class=footer__links><nav><a class=text-white href=/zh/docs/home/>主页</a>
<a class=text-white href=/zh/blog/>博客</a>
<a class=text-white href=/zh/training/>培训</a>
<a class=text-white href=/zh/partners/>合作伙伴</a>
<a class=text-white href=/zh/community/>社区</a>
<a class=text-white href=/zh/case-studies/>案例分析</a></nav></div><div class=container-fluid><div class=row><div class="col-6 col-sm-2 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank href=https://discuss.kubernetes.io><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank href=https://twitter.com/kubernetesio><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Calendar aria-label=Calendar><a class=text-white target=_blank href="https://calendar.google.com/calendar/embed?src=calendar%40kubernetes.io"><i class="fas fa-calendar-alt"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube><a class=text-white target=_blank href=https://youtube.com/kubernetescommunity><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-2 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank href=https://github.com/kubernetes/kubernetes><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank href=https://slack.k8s.io><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Contribute aria-label=Contribute><a class=text-white target=_blank href=https://git.k8s.io/community/contributors/guide><i class="fas fa-edit"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank href=https://stackoverflow.com/questions/tagged/kubernetes><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="col-12 col-sm-8 text-center order-sm-2"><small class=text-white>&copy; 2023 The Kubernetes 作者 | 文档发布基于 <a href=https://git.k8s.io/website/LICENSE class=light-text>CC BY 4.0</a> 授权许可</small><br><small class=text-white>Copyright &copy; 2023 Linux 基金会&reg;。保留所有权利。Linux 基金会已注册并使用商标。如需了解 Linux 基金会的商标列表，请访问<a href=https://www.linuxfoundation.org/trademark-usage class=light-text>商标使用页面</a></small><br><small class=text-white>ICP license: 京ICP备17074266号-3</small></div></div></div></footer></div><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script><script src=/js/main.min.4c88b9704d4f4a0c299df9314d9912a9d1b77eed43f42923d7e1efd15c8ed139.js integrity="sha256-TIi5cE1PSgwpnfkxTZkSqdG3fu1D9Ckj1+Hv0VyO0Tk=" crossorigin=anonymous></script></body></html>